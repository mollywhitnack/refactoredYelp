"use strict";var app=angular.module("myApp",["ui.router","satellizer","ngFileUpload"]);app.config(["$authProvider",function(e){e.loginUrl="api/users/login",e.signupUrl="api/users/signup",e.facebook({clientId:"255060128209165",url:"/api/users/facebook"})}]),app.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"/html/home.html"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}).state("register",{url:"/register",templateUrl:"/html/register.html",controller:"registerCtrl"}).state("profile",{url:"/profile/:userId",templateUrl:"/html/profile.html",controller:"profileCtrl",resolve:{Profile:["User",function(e){return e.profile()}],ProfileByID:["User","$stateParams",function(e,t){return e.getProfile(t.userId)}]}}).state("users",{url:"/users",templateUrl:"/html/users.html",controller:"usersCtrl"}).state("business",{url:"/business",templateUrl:"/html/business.html",controller:"businessCtrl",resolve:{Profile:["User",function(e){return e.profile()}]}}).state("showBusiness",{url:"/business/:businessId",templateUrl:"html/showbusiness.html",controller:"showbusinessCtrl",resolve:{Profile:["User",function(e){return e.profile()}]}}),t.otherwise("/")}]);var app=angular.module("myApp");app.controller("businessCtrl",["$scope","User","$rootScope","Business","Profile",function(e,t,o,n,r){e.businesses=[];var s=r.favorites;e.searchBusiness=function(){n.searchYelp(e.newItem.searchParams).then(function(t){for(var o=0;o<s.length;o++)t.id===s[o]&&(e.toggleFave=!0);e.businesses.push(t)})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.searchBusiness2=function(){var t={};e.newItem.location&&(t.location=e.newItem.location),e.newItem.term&&(t.term=e.newItem.term),n.searchCatagories(t).then(function(t){e.toggleFave=new Array(t.businesses.length);for(var o=0;o<t.businesses.length;o++)for(var n=0;n<s.length;n++)console.log(),t.businesses[o].id===s[n]?e.toggleFave[o]=1:e.toggleFave[o]=0;e.businesses=t.businesses})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.favorite=function(o){e.toggleFave[o]=!e.toggleFave[o],t.addFavoriteToUser(r._id,e.businesses[o].id).then(n.addFavorite(e.businesses[o],r._id)).then(function(e){})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.unFavorite=function(o){e.toggleFave[o]=!e.toggleFave[o],t.removeFavoritefromUser(r._id,e.businesses[o].id).then(function(e){console.log("res:",e)})["catch"](function(e){console.log("err in businessCtrl: ",e)})}}]);var app=angular.module("myApp");app.controller("imageCtrl",["$scope","Upload","Profile","$rootScope",function(e,t,o,n){console.log("image ctrl"),n.currentUser=o,e.submit=function(){console.log("submit"),console.log("$scope.file:",e.file),t.upload({url:"/api/images",data:{photo:e.file,user:n.currentUser._id}}).then(function(t){console.log("res: ",t),e.savedImage=t.data})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("loginCtrl",["$scope","$state","$auth","$rootScope",function(e,t,o,n){console.log("loginCtrl!"),e.login=function(){o.login(e.user).then(function(e){console.log("res: ",e),t.go("profile")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("mainCtrl",["$scope","$state","$auth","$rootScope",function(e,t,o,n){n.currentUser,e.isAuthenticated=function(){return o.isAuthenticated()},e.logout=function(){o.logout(),t.go("home")},e.authenticate=function(e){o.authenticate(e).then(function(e){t.go("home")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("profileCtrl",["$scope","Profile","ProfileByID","$state","User","$rootScope","WallPost",function(e,t,o,n,r,s,l){s.currentUser=t,e.user=o||t,l.getWallPosts(e.user._id).then(function(t){e.userWallposts=t}),e.showdisplayNameForm=function(){console.log("show form"),e.displayNameForm=!0},e.updatedisplayName=function(){e.displayNameForm=!1,e.user.displayName=e.newItem.displayName,r.updateProfile(e.user._id,e.newItem).then(function(t){console.log("profile:",t),e.newItem.displayName=""})["catch"](function(e){console.log("err:",e)})},e.canceldisplayName=function(){e.usernameForm=!0,e.newItem.displayName=""},e.showPictureForm=function(){console.log("show form"),e.photoForm=!0},e.updatePicture=function(){e.photoForm=!1,console.log("$state.current: ",n.current),e.user.profileImage=e.newItem.profileImage,console.log("$scope.newItem:",e.newItem),r.updateProfile(e.user._id,e.newItem).then(function(t){console.log("profile:",t),e.newItem.profileImage=""})["catch"](function(e){console.log("err:",e)})},e.cancelPhotoUrl=function(){e.photoForm=!0,e.newItem.photoUrl=""},e.deleteAccount=function(e){console.log(e._id),r.deleteAccount(e._id).then()["catch"](function(e){console.log("err: ",e)})},e.submitMessage=function(){var t={to:e.user,from:s.currentUser._id,fromName:s.currentUser.displayName,text:e.newItem.text,createdAt:"add moment"};l.addWallPost(t).then(function(e){r.addWallPostToUser(o._id,e._id)}).then(n.go(n.$current,null,{reload:!0}))["catch"](function(e){console.log("err: ",e)})}}]);var app=angular.module("myApp");app.controller("registerCtrl",["$scope","$state","$auth",function(e,t,o){console.log("registerCtrl!"),e.register=function(){e.user.password!==e.user.password2?(e.user.password=null,e.user.password2=null,alert("Passwords must match!")):o.signup(e.user).then(function(e){console.log("res: ",e),t.go("login")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("showbusinessCtrl",["$scope","$stateParams","Business","Profile","User",function(e,t,o,n,r){e.showButton=!1,e.singletoggleFave=!1;var s=n.favorites,l=t;o.searchYelp(l.businessId).then(function(t){e.business=t,e.showButton=!0;for(var o=0;o<s.length;o++)s[o]===t.id&&(e.singletoggleFave=!0)})["catch"](function(e){console.log("err in businessCtrl: ",e)}),e.favorite=function(){e.singletoggleFave=!e.singletoggleFave,r.addFavoriteToUser(n._id,e.business.id).then(o.addFavorite(e.business,n._id)).then(function(e){})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.unFavorite=function(){e.singletoggleFave=!e.singletoggleFave,r.removeFavoritefromUser(n._id,e.business.id).then(function(e){})["catch"](function(e){console.log("err in businessCtrl: ",e)})}}]);var app=angular.module("myApp");app.controller("usersCtrl",["$scope","$$state","$state","User",function(e,t,o,n){var r=n.getAll();r.then(function(t){e.userFeed=t.data})}]);var app=angular.module("myApp");app.service("Business",["$http","$q",function(e,t){this.getMap=function(o){return e.get("/api/businesses/map",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.searchYelp=function(o){return e.get("/api/businesses/yelp/"+o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.searchCatagories=function(o){return e.post("/api/businesses/yelp/yelpCatagories",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.addFavorite=function(o,n){return e.post("/api/businesses/"+n,o).then(function(e){return t.resolve(e)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("image",["$http","$q",function(e,t){this.getAll=function(){return e.get("/api/cruds")},this.getById=function(t){return e.get("/api/cruds/"+t)},this.addCrud=function(o){return e.post("/api/cruds",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.deleteCrud=function(o){return e["delete"]("/api/cruds/"+o).then(function(){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.updateCrud=function(o,n){return e.put("/api/cruds/"+o,n).then(function(e){return t.resolve(n)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("User",["$http","$q",function(e,t){this.profile=function(){return e.get("/api/users/profile").then(function(e){return t.resolve(e.data)})},this.getProfile=function(o){return e.get("/api/users/profile/"+o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getAll=function(){return e.get("/api/users")},this.updateProfile=function(o,n){return e.put("/api/users/profile/"+o,n).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.deleteAccount=function(o){return e["delete"]("/api/users/profile/"+o).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.addFavoriteToUser=function(o,n){return e.put("/api/users/profile/"+o+"/add/"+n).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.removeFavoritefromUser=function(o,n){return e.put("/api/users/profile/"+o+"/remove/"+n).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("WallPost",["$http","$q",function(e,t){this.addWallPost=function(o){return console.log("in add wallpost: ",o),e.post("/api/wallposts",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getWallPosts=function(o){return e.get("/api/wallposts/"+o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err: ",e)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2J1c2luZXNzQ3RybC5qcyIsImNvbnRyb2xsZXJzL2ltYWdlQ3RybC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL21haW5DdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUN0cmwuanMiLCJjb250cm9sbGVycy9yZWdpc3RlckN0cmwuanMiLCJjb250cm9sbGVycy9zaG93YnVzaW5lc3NDdHJsLmpzIiwiY29udHJvbGxlcnMvdXNlcnNDdHJsLmpzIiwic2VydmljZXMvYnVzaW5lc3NzZXJ2aWNlcy5qcyIsInNlcnZpY2VzL2ltYWdlc2VydmljZXMuanMiLCJzZXJ2aWNlcy91c2Vyc2VydmljZXMuanMiLCJzZXJ2aWNlcy93YWxscG9zdHNlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkYXV0aFByb3ZpZGVyIiwibG9naW5VcmwiLCJzaWdudXBVcmwiLCJmYWNlYm9vayIsImNsaWVudElkIiwidXJsIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInJlc29sdmUiLCJQcm9maWxlIiwiVXNlciIsInByb2ZpbGUiLCJQcm9maWxlQnlJRCIsIiRzdGF0ZVBhcmFtcyIsImdldFByb2ZpbGUiLCJ1c2VySWQiLCJvdGhlcndpc2UiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiQnVzaW5lc3MiLCJidXNpbmVzc2VzIiwiZmF2b3JpdGVzIiwic2VhcmNoQnVzaW5lc3MiLCJzZWFyY2hZZWxwIiwibmV3SXRlbSIsInNlYXJjaFBhcmFtcyIsInRoZW4iLCJyZXMiLCJpIiwibGVuZ3RoIiwiaWQiLCJ0b2dnbGVGYXZlIiwicHVzaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJzZWFyY2hCdXNpbmVzczIiLCJzZWFyY2hCeSIsImxvY2F0aW9uIiwidGVybSIsInNlYXJjaENhdGFnb3JpZXMiLCJBcnJheSIsImsiLCJmYXZvcml0ZSIsImluZGV4IiwiYWRkRmF2b3JpdGVUb1VzZXIiLCJfaWQiLCJhZGRGYXZvcml0ZSIsInVuRmF2b3JpdGUiLCJyZW1vdmVGYXZvcml0ZWZyb21Vc2VyIiwiVXBsb2FkIiwiY3VycmVudFVzZXIiLCJzdWJtaXQiLCJmaWxlIiwidXBsb2FkIiwiZGF0YSIsInBob3RvIiwidXNlciIsInNhdmVkSW1hZ2UiLCIkc3RhdGUiLCIkYXV0aCIsImxvZ2luIiwiZ28iLCJpc0F1dGhlbnRpY2F0ZWQiLCJsb2dvdXQiLCJhdXRoZW50aWNhdGUiLCJwcm92aWRlciIsIldhbGxQb3N0IiwiZ2V0V2FsbFBvc3RzIiwidXNlcldhbGxwb3N0cyIsInNob3dkaXNwbGF5TmFtZUZvcm0iLCJkaXNwbGF5TmFtZUZvcm0iLCJ1cGRhdGVkaXNwbGF5TmFtZSIsImRpc3BsYXlOYW1lIiwidXBkYXRlUHJvZmlsZSIsImNhbmNlbGRpc3BsYXlOYW1lIiwidXNlcm5hbWVGb3JtIiwic2hvd1BpY3R1cmVGb3JtIiwicGhvdG9Gb3JtIiwidXBkYXRlUGljdHVyZSIsImN1cnJlbnQiLCJwcm9maWxlSW1hZ2UiLCJjYW5jZWxQaG90b1VybCIsInBob3RvVXJsIiwiZGVsZXRlQWNjb3VudCIsInN1Ym1pdE1lc3NhZ2UiLCJwb3N0T2JqIiwidG8iLCJmcm9tIiwiZnJvbU5hbWUiLCJ0ZXh0IiwiY3JlYXRlZEF0IiwiYWRkV2FsbFBvc3QiLCJ3YWxscG9zdCIsImFkZFdhbGxQb3N0VG9Vc2VyIiwiJGN1cnJlbnQiLCJyZWxvYWQiLCJyZWdpc3RlciIsInBhc3N3b3JkIiwicGFzc3dvcmQyIiwiYWxlcnQiLCJzaWdudXAiLCJzaG93QnV0dG9uIiwic2luZ2xldG9nZ2xlRmF2ZSIsImJ1c2luZXNzSWQiLCJidXNpbmVzcyIsIiQkc3RhdGUiLCJ1c2VyUHJvbWlzZSIsImdldEFsbCIsInJlc3VsdCIsInVzZXJGZWVkIiwic2VydmljZSIsIiRodHRwIiwiJHEiLCJ0aGlzIiwiZ2V0TWFwIiwiY29yZHMiLCJnZXQiLCJzZWFyY2giLCJpbnB1dHMiLCJwb3N0IiwiYnVzaW5lc3NPYmoiLCJnZXRCeUlkIiwiYWRkQ3J1ZCIsImNydWQiLCJkZWxldGVDcnVkIiwidXBkYXRlQ3J1ZCIsInB1dCIsInByb2ZpbGVPYmoiLCJ5ZWxwSWQiXSwibWFwcGluZ3MiOiJBQUFBLFlBRUEsSUFBSUEsS0FBTUMsUUFBUUMsT0FBTyxTQUFVLFlBQWEsYUFBYyxnQkFFOURGLEtBQUlHLFFBQUEsZ0JBQU8sU0FBU0MsR0FFbEJBLEVBQWNDLFNBQVcsa0JBQ3pCRCxFQUFjRSxVQUFZLG1CQUUxQkYsRUFBY0csVUFDWkMsU0FBVSxrQkFDVkMsSUFBSywyQkFLVFQsSUFBSUcsUUFBQSxpQkFBQSxxQkFBTyxTQUFTTyxFQUFnQkMsR0FFbENELEVBQ0dFLE1BQU0sUUFBVUgsSUFBSyxJQUFLSSxZQUFhLG9CQUN2Q0QsTUFBTSxTQUNMSCxJQUFLLFNBQ0xJLFlBQWEsbUJBQ2JDLFdBQVksY0FFYkYsTUFBTSxZQUNMSCxJQUFLLFlBQ0xJLFlBQWEsc0JBQ2JDLFdBQVksaUJBRWJGLE1BQU0sV0FDTEgsSUFBSyxtQkFDTEksWUFBYSxxQkFDYkMsV0FBWSxjQUNaQyxTQUNFQyxTQUFBLE9BQVMsU0FBU0MsR0FDaEIsTUFBT0EsR0FBS0MsWUFFZEMsYUFBQSxPQUFBLGVBQWEsU0FBU0YsRUFBTUcsR0FDMUIsTUFBT0gsR0FBS0ksV0FBV0QsRUFBYUUsYUFJekNWLE1BQU0sU0FDTEgsSUFBSyxTQUNMSSxZQUFhLG1CQUNiQyxXQUFZLGNBRWJGLE1BQU0sWUFDTEgsSUFBSyxZQUNMSSxZQUFhLHNCQUNiQyxXQUFZLGVBQ1pDLFNBQ0VDLFNBQUEsT0FBUyxTQUFTQyxHQUNoQixNQUFPQSxHQUFLQyxlQUlqQk4sTUFBTSxnQkFDTEgsSUFBSyx3QkFDTEksWUFBYSx5QkFDYkMsV0FBWSxtQkFDWkMsU0FDRUMsU0FBQSxPQUFTLFNBQVNDLEdBQ2hCLE1BQU9BLEdBQUtDLGVBS3BCUCxFQUFtQlksVUFBVSxPQ25FL0IsSUFB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L0N2RyxLQUFLLFNBQUFDLEdBQ0gsTUFBT3NGLEdBQUd6RyxZQUZQd0csU0FJQSxTQUFBL0UsR0FDTEMsUUFBUUMsSUFBSSxPQUFRRixNQUl4QmlGLEtBQUtqRSx1QkFBeUIsU0FBQ25CLEVBQUltRyxHQUNqQyxNQUFPakIsR0FBTWUsSUFBTixzQkFBZ0NqRyxFQUFoQyxXQUE2Q21HLEdBQ2xEdkcsS0FBSyxTQUFBQyxHQUNILE1BQU9zRixHQUFHekcsWUFGUHdHLFNBSUEsU0FBQS9FLEdBQ0xDLFFBQVFDLElBQUksT0FBUUYsUUM3RDFCLElBQUl4QyxLQUFNQyxRQUFRQyxPQUFPLFFBRXpCRixLQUFJc0gsUUFBUSxZQUFBLFFBQUEsS0FBWSxTQUFTQyxFQUFPQyxHQUVwQ0MsS0FBS3RCLFlBQWEsU0FBQ0MsR0FFbkIsTUFEQTNELFNBQVFDLElBQUksb0JBQXFCMEQsR0FDMUJtQixFQUFNUSxLQUFOLGlCQUE2QjNCLEdBQ2pDbkUsS0FBSyxTQUFBQyxHQUNKLE1BQU9zRixHQUFHekcsUUFBUW1CLEVBQUk0QixRQUZuQnlELFNBSUUsU0FBQS9FLEdBQ0xDLFFBQVFDLElBQUksT0FBUUYsTUFLeEJpRixLQUFLOUMsYUFBZSxTQUFDckQsR0FDckIsTUFBT2lHLEdBQU1LLElBQU4sa0JBQTRCdEcsR0FDaENXLEtBQUssU0FBQUMsR0FDSixNQUFPc0YsR0FBR3pHLFFBQVFtQixFQUFJNEIsUUFGbkJ5RCxTQUlFLFNBQUEvRSxHQUNMQyxRQUFRQyxJQUFJLFFBQVNGIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcsIFsndWkucm91dGVyJywgJ3NhdGVsbGl6ZXInLCAnbmdGaWxlVXBsb2FkJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uKCRhdXRoUHJvdmlkZXIpIHtcblxuICAkYXV0aFByb3ZpZGVyLmxvZ2luVXJsID0gJ2FwaS91c2Vycy9sb2dpbic7XG4gICRhdXRoUHJvdmlkZXIuc2lnbnVwVXJsID0gJ2FwaS91c2Vycy9zaWdudXAnO1xuXG4gICRhdXRoUHJvdmlkZXIuZmFjZWJvb2soe1xuICAgIGNsaWVudElkOiAnMjU1MDYwMTI4MjA5MTY1JyxcbiAgICB1cmw6ICcvYXBpL3VzZXJzL2ZhY2Vib29rJ1xuICB9KTtcblxufSk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gICRzdGF0ZVByb3ZpZGVyXG4gICAgLnN0YXRlKCdob21lJywgeyB1cmw6ICcvJywgdGVtcGxhdGVVcmw6ICcvaHRtbC9ob21lLmh0bWwnIH0pXG4gICAgLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2xvZ2luLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICB9KVxuICAgIC5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9yZWdpc3Rlci5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdyZWdpc3RlckN0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2ZpbGUnLCB7XG4gICAgICB1cmw6ICcvcHJvZmlsZS86dXNlcklkJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlQ3RybCcsXG4gICAgICByZXNvbHZlOiB7XG4gICAgICAgIFByb2ZpbGU6IGZ1bmN0aW9uKFVzZXIpIHtcbiAgICAgICAgICByZXR1cm4gVXNlci5wcm9maWxlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIFByb2ZpbGVCeUlEOiBmdW5jdGlvbihVc2VyLCAkc3RhdGVQYXJhbXMpe1xuICAgICAgICAgIHJldHVybiBVc2VyLmdldFByb2ZpbGUoJHN0YXRlUGFyYW1zLnVzZXJJZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICAgIC5zdGF0ZSgndXNlcnMnLCB7XG4gICAgICB1cmw6ICcvdXNlcnMnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC91c2Vycy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICd1c2Vyc0N0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ2J1c2luZXNzJywge1xuICAgICAgdXJsOiAnL2J1c2luZXNzJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvYnVzaW5lc3MuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnYnVzaW5lc3NDdHJsJyxcbiAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgUHJvZmlsZTogZnVuY3Rpb24oVXNlcikge1xuICAgICAgICAgIHJldHVybiBVc2VyLnByb2ZpbGUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgLnN0YXRlKCdzaG93QnVzaW5lc3MnLCB7XG4gICAgICB1cmw6ICcvYnVzaW5lc3MvOmJ1c2luZXNzSWQnLCBcbiAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC9zaG93YnVzaW5lc3MuaHRtbCcsIFxuICAgICAgY29udHJvbGxlcjogJ3Nob3didXNpbmVzc0N0cmwnLCAgICAgIFxuICAgICAgcmVzb2x2ZToge1xuICAgICAgICBQcm9maWxlOiBmdW5jdGlvbihVc2VyKSB7XG4gICAgICAgICAgcmV0dXJuIFVzZXIucHJvZmlsZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB9KVxuICAgIFxuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG59KTtcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdidXNpbmVzc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXIsICRyb290U2NvcGUsIEJ1c2luZXNzLCBQcm9maWxlKXtcblxuICAkc2NvcGUuYnVzaW5lc3NlcyA9IFtdO1xuICB2YXIgZmF2b3JpdGVzID0gUHJvZmlsZS5mYXZvcml0ZXM7XG5cbiAgJHNjb3BlLnNlYXJjaEJ1c2luZXNzID0gKCkgPT4ge1xuICAgICAgQnVzaW5lc3Muc2VhcmNoWWVscCgkc2NvcGUubmV3SXRlbS5zZWFyY2hQYXJhbXMpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPCBmYXZvcml0ZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgIGlmKHJlcy5pZCA9PT0gZmF2b3JpdGVzW2ldKXtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVGYXZlID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmJ1c2luZXNzZXMucHVzaChyZXMpO1xuICAgICAgfSkgICAgXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9XG5cbiAgJHNjb3BlLnNlYXJjaEJ1c2luZXNzMiA9ICgpID0+IHtcbiAgICAgIHZhciBzZWFyY2hCeSA9IHt9O1xuICAgICAgaWYoJHNjb3BlLm5ld0l0ZW0ubG9jYXRpb24pe1xuICAgICAgICBzZWFyY2hCeS5sb2NhdGlvbiA9ICRzY29wZS5uZXdJdGVtLmxvY2F0aW9uXG4gICAgICB9XG4gICAgICBpZigkc2NvcGUubmV3SXRlbS50ZXJtKXtcbiAgICAgICAgc2VhcmNoQnkudGVybSA9ICRzY29wZS5uZXdJdGVtLnRlcm07XG4gICAgICB9XG5cbiAgICAgIEJ1c2luZXNzLnNlYXJjaENhdGFnb3JpZXMoc2VhcmNoQnkpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgICRzY29wZS50b2dnbGVGYXZlID0gbmV3IEFycmF5KHJlcy5idXNpbmVzc2VzLmxlbmd0aClcblxuICAgICAgICAvL2NoZWNrIGZvciBmYXZvcml0ZXNcbiAgICAgICAgZm9yKHZhciBrPTA7IGs8cmVzLmJ1c2luZXNzZXMubGVuZ3RoOyBrKyspe1xuICAgICAgICAgIGZvcih2YXIgaT0wOyBpPCBmYXZvcml0ZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgY29uc29sZS5sb2coKVxuICAgICAgICAgICAgaWYocmVzLmJ1c2luZXNzZXNba10uaWQgPT09IGZhdm9yaXRlc1tpXSl7XG4gICAgICAgICAgICAgICRzY29wZS50b2dnbGVGYXZlW2tdID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgJHNjb3BlLnRvZ2dsZUZhdmVba10gPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuYnVzaW5lc3NlcyA9IHJlcy5idXNpbmVzc2VzO1xuXG4gICAgICB9KSAgICBcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KVxuICAgIH1cblxuXG4gICAgLy9hZGQgdG8gdXNlciBmYXZvcml0ZXNcbiAgICAkc2NvcGUuZmF2b3JpdGUgPSAoaW5kZXgpPT57XG4gICAgICAkc2NvcGUudG9nZ2xlRmF2ZVtpbmRleF0gPSAhJHNjb3BlLnRvZ2dsZUZhdmVbaW5kZXhdO1xuICAgICAgVXNlci5hZGRGYXZvcml0ZVRvVXNlciggUHJvZmlsZS5faWQsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZClcbiAgICAgIC50aGVuKEJ1c2luZXNzLmFkZEZhdm9yaXRlKCRzY29wZS5idXNpbmVzc2VzW2luZGV4XSwgUHJvZmlsZS5faWQpKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkgICAgXG4gICAgfVxuXG4gICAgJHNjb3BlLnVuRmF2b3JpdGUgPSAoaW5kZXgpPT57XG4gICAgICAkc2NvcGUudG9nZ2xlRmF2ZVtpbmRleF0gPSAhJHNjb3BlLnRvZ2dsZUZhdmVbaW5kZXhdO1xuICAgICAgVXNlci5yZW1vdmVGYXZvcml0ZWZyb21Vc2VyKCBQcm9maWxlLl9pZCwgJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkKVxuICAgICAgLy8udGhlbihCdXNpbmVzcy5yZW1vdmVGYXZvcml0ZSgkc2NvcGUuYnVzaW5lc3Nlc1tpbmRleF0sIFByb2ZpbGUuX2lkKSlcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXM6XCIgLCByZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KSAgICBcbiAgICB9XG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignaW1hZ2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVcGxvYWQsIFByb2ZpbGUsICRyb290U2NvcGUpIHtcbiAgY29uc29sZS5sb2coXCJpbWFnZSBjdHJsXCIpO1xuXG5cbiAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IFByb2ZpbGU7XG5cbiAgJHNjb3BlLnN1Ym1pdCA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKCdzdWJtaXQnKTtcbiAgICBjb25zb2xlLmxvZygnJHNjb3BlLmZpbGU6JywgJHNjb3BlLmZpbGUpO1xuICAgIFxuICAgIFVwbG9hZC51cGxvYWQoe1xuICAgICAgdXJsOiAnL2FwaS9pbWFnZXMnLFxuICAgICAgZGF0YToge3Bob3RvOiAkc2NvcGUuZmlsZSwgdXNlcjogJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWR9IC8vYW55dGhpbmcgZWxzZSBsaWtlIG5hbWUgd2lsbCBlbmQgdXAgaW4gcmVxLmJvZHlcbiAgICB9KVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcyk7XG4gICAgICAkc2NvcGUuc2F2ZWRJbWFnZSA9IHJlcy5kYXRhO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpXG4gICAgfSlcbiAgfTtcblxufSk7XG5cbiAgLyokc2NvcGUuY3J1ZHMgPSBbXTtcblxuICBDcnVkLmdldEFsbCgpXG4gIC50aGVuKHJlcyA9PntcbiAgICAkc2NvcGUuY3J1ZHMgPSByZXMuZGF0YTtcbiAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5jcnVkczpcIiwgJHNjb3BlLmNydWRzKTtcbiAgfSlcbiAgLmNhdGNoKGVyciA9PntcbiAgICBjb25zb2xlLmxvZyhcImVycjogXCIsIGVycik7XG4gIH0pXG5cbiAgJHNjb3BlLmFkZENydWQgPSAoKSA9PntcbiAgICBDcnVkLmFkZENydWQoJHNjb3BlLm5ld0l0ZW0pXG4gICAgLnRoZW4oY3J1ZCA9PntcbiAgICAgICRzY29wZS5jcnVkcy5wdXNoKGNydWQpO1xuICAgICAgJHNjb3BlLm5ld0l0ZW0gPSB7fTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnI9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3I6IFwiLCBlcnIgKTtcbiAgICB9KTtcbiAgfVxuXG5cbiAgJHNjb3BlLmRlbGV0ZUNydWQgPSAoaW5kLCBjcnVkKSA9PntcbiAgICBjb25zb2xlLmxvZyhcImNydWQ6XCIsIGNydWQpXG4gICAgQ3J1ZC5kZWxldGVDcnVkKGNydWQuX2lkKVxuICAgIC50aGVuKGNydWQgPT4ge1xuICAgICAgJHNjb3BlLmNydWRzLnNwbGljZShpbmQsMSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycm9yOiBcIiwgZXJyICk7XG4gICAgfSk7XG4gIH1cblxuICAkc2NvcGUuc2hvd1VwZGF0ZUZvcm0gPSAoaW5kZXgsIGNydWQpID0+e1xuICAgIGNvbnNvbGUubG9nKFwiaW5kZXg6IFwiLCBpbmRleCk7XG4gICAgY29uc29sZS5sb2coXCJjcnVkOiBcIiwgY3J1ZCk7XG4gICAgJHNjb3BlLnNob3dVcGRhdGUgPXRydWU7XG4gICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBjcnVkO1xuICAgICRzY29wZS51cGRhdGVJbmRleCA9IGluZGV4O1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZUNydWQ9ICgpID0+e1xuICAgICRzY29wZS5zaG93VXBkYXRlID1mYWxzZTtcbiAgICBDcnVkLnVwZGF0ZUNydWQoJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCAkc2NvcGUudXBkYXRlSXRlbSlcbiAgICAudGhlbihjcnVkID0+e1xuICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGUgYXB0OlwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCBcIiAsIFwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycj0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnJvcjogXCIsIGVyciApO1xuICAgIH0pO1xuICB9XG4qL1xuXG4iLCJcbid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRhdXRoLCAkcm9vdFNjb3BlKSB7XG4gIGNvbnNvbGUubG9nKCdsb2dpbkN0cmwhJyk7XG5cbiAgJHNjb3BlLmxvZ2luID0gKCkgPT4ge1xuICAgICAgJGF1dGgubG9naW4oJHNjb3BlLnVzZXIpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOiBcIiwgcmVzKTtcbiAgICAgICAgLy8kcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGE7XG4gICAgICAgICRzdGF0ZS5nbygncHJvZmlsZScpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdtYWluQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkYXV0aCwgJHJvb3RTY29wZSkge1xuXG4gICRyb290U2NvcGUuY3VycmVudFVzZXI7XG5cbiAgJHNjb3BlLmlzQXV0aGVudGljYXRlZCA9ICgpID0+ICRhdXRoLmlzQXV0aGVudGljYXRlZCgpO1xuXG4gICRzY29wZS5sb2dvdXQgPSAoKSA9PiB7XG4gICAgJGF1dGgubG9nb3V0KCk7XG4gICAgJHN0YXRlLmdvKCdob21lJyk7XG4gIH07XG5cbiAgJHNjb3BlLmF1dGhlbnRpY2F0ZSA9IHByb3ZpZGVyID0+IHtcbiAgICAkYXV0aC5hdXRoZW50aWNhdGUocHJvdmlkZXIpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgfTtcbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdwcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgUHJvZmlsZSwgUHJvZmlsZUJ5SUQsICRzdGF0ZSwgVXNlciwgJHJvb3RTY29wZSwgV2FsbFBvc3QpIHtcbiAgXG4gICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBQcm9maWxlO1xuXG4gICRzY29wZS51c2VyID0gUHJvZmlsZUJ5SUQgfHwgUHJvZmlsZTtcblxuICBXYWxsUG9zdC5nZXRXYWxsUG9zdHMoJHNjb3BlLnVzZXIuX2lkKVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAkc2NvcGUudXNlcldhbGxwb3N0cyA9IHJlcztcbiAgfSlcblxuICAkc2NvcGUuc2hvd2Rpc3BsYXlOYW1lRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZWRpc3BsYXlOYW1lID0gKCkgPT4ge1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSBmYWxzZTtcbiAgICAkc2NvcGUudXNlci5kaXNwbGF5TmFtZSA9ICRzY29wZS5uZXdJdGVtLmRpc3BsYXlOYW1lO1xuICAgIFVzZXIudXBkYXRlUHJvZmlsZSgkc2NvcGUudXNlci5faWQsICRzY29wZS5uZXdJdGVtKVxuICAgICAgLnRoZW4ocHJvZmlsZSA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJwcm9maWxlOlwiLCBwcm9maWxlKTtcbiAgICAgICAgJHNjb3BlLm5ld0l0ZW0uZGlzcGxheU5hbWUgPSAnJztcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICAkc2NvcGUuY2FuY2VsZGlzcGxheU5hbWUgPSAoKSA9PntcbiAgICAkc2NvcGUudXNlcm5hbWVGb3JtID0gdHJ1ZTtcbiAgICAkc2NvcGUubmV3SXRlbS5kaXNwbGF5TmFtZSA9ICcnO1xuICB9XG5cbi8vcGhvdG9cbiAgJHNjb3BlLnNob3dQaWN0dXJlRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZVBpY3R1cmUgPSAoKSA9PiB7XG4gICAgJHNjb3BlLnBob3RvRm9ybSA9IGZhbHNlO1xuICAgIGNvbnNvbGUubG9nKFwiJHN0YXRlLmN1cnJlbnQ6IFwiLCAkc3RhdGUuY3VycmVudCk7XG4gICAgJHNjb3BlLnVzZXIucHJvZmlsZUltYWdlID0gJHNjb3BlLm5ld0l0ZW0ucHJvZmlsZUltYWdlO1xuICAgIGNvbnNvbGUubG9nKFwiJHNjb3BlLm5ld0l0ZW06XCIsICRzY29wZS5uZXdJdGVtKTtcbiAgICBVc2VyLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLnVzZXIuX2lkLCAkc2NvcGUubmV3SXRlbSlcbiAgICAgIC50aGVuKHByb2ZpbGUgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZTpcIiwgcHJvZmlsZSk7XG4gICAgICAgICRzY29wZS5uZXdJdGVtLnByb2ZpbGVJbWFnZSA9ICcnO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgfVxuXG4gICRzY29wZS5jYW5jZWxQaG90b1VybCA9ICgpID0+e1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICAgICRzY29wZS5uZXdJdGVtLnBob3RvVXJsID0gJyc7XG4gIH1cblxuXG4gICRzY29wZS5kZWxldGVBY2NvdW50ID0gKHVzZXIpID0+e1xuICAgIC8vYWRkIHN3YWxcbiAgICBjb25zb2xlLmxvZyh1c2VyLl9pZCk7XG4gICAgVXNlci5kZWxldGVBY2NvdW50KHVzZXIuX2lkKVxuICAgICAgLnRoZW4oKVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6IFwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICAgICRzY29wZS5zdWJtaXRNZXNzYWdlID0gKCkgPT57XG5cbiAgICB2YXIgcG9zdE9iaiA9IHtcbiAgICAgIHRvOiAkc2NvcGUudXNlcixcbiAgICAgIGZyb206ICRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkLFxuICAgICAgZnJvbU5hbWU6ICRyb290U2NvcGUuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXG4gICAgICB0ZXh0OiAkc2NvcGUubmV3SXRlbS50ZXh0LFxuICAgICAgY3JlYXRlZEF0OiBcImFkZCBtb21lbnRcIlxuICAgIH07XG5cblxuICAgIFdhbGxQb3N0LmFkZFdhbGxQb3N0KHBvc3RPYmopXG4gICAgICAudGhlbih3YWxscG9zdCA9PntcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIndhbGxwb3N0OlwiICwgd2FsbHBvc3QpO1xuICAgICAgICBVc2VyLmFkZFdhbGxQb3N0VG9Vc2VyKFByb2ZpbGVCeUlELl9pZCwgd2FsbHBvc3QuX2lkKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigkc3RhdGUuZ28oJHN0YXRlLiRjdXJyZW50LCBudWxsLCB7IHJlbG9hZDogdHJ1ZSB9KSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOiBcIiwgZXJyKTtcbiAgICAgIH0pXG4gICB9O1xuXG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRhdXRoKSB7XG4gIGNvbnNvbGUubG9nKCdyZWdpc3RlckN0cmwhJyk7XG5cbiAgJHNjb3BlLnJlZ2lzdGVyID0gKCkgPT4ge1xuICAgIGlmKCRzY29wZS51c2VyLnBhc3N3b3JkICE9PSAkc2NvcGUudXNlci5wYXNzd29yZDIpe1xuICAgICAgJHNjb3BlLnVzZXIucGFzc3dvcmQgPSBudWxsO1xuICAgICAgJHNjb3BlLnVzZXIucGFzc3dvcmQyID0gbnVsbDtcbiAgICAgIGFsZXJ0KCdQYXNzd29yZHMgbXVzdCBtYXRjaCEnKTtcbiAgICB9ZWxzZXtcbiAgICAgICRhdXRoLnNpZ251cCgkc2NvcGUudXNlcilcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXM6IFwiLCByZXMpO1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICB9KVxuICAgIH1cbiAgfTtcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5cbmFwcC5jb250cm9sbGVyKCdzaG93YnVzaW5lc3NDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGVQYXJhbXMsIEJ1c2luZXNzLCBQcm9maWxlLCBVc2VyKSB7XG5cbiAgJHNjb3BlLnNob3dCdXR0b24gPSBmYWxzZTtcbiAgJHNjb3BlLnNpbmdsZXRvZ2dsZUZhdmUgPSBmYWxzZTtcbiAgdmFyIGZhdm9yaXRlcyA9IFByb2ZpbGUuZmF2b3JpdGVzO1xuXG4gIGxldCBidXNpbmVzc0lkID0gJHN0YXRlUGFyYW1zO1xuXG4gIEJ1c2luZXNzLnNlYXJjaFllbHAoYnVzaW5lc3NJZC5idXNpbmVzc0lkKVxuICAudGhlbihyZXMgPT57XG4gICAgJHNjb3BlLmJ1c2luZXNzID0gcmVzO1xuICAgICRzY29wZS5zaG93QnV0dG9uID0gdHJ1ZTtcbiAgICBmb3IodmFyIGkgPTA7IGk8IGZhdm9yaXRlcy5sZW5ndGg7IGkrKyl7XG4gICAgICBpZihmYXZvcml0ZXNbaV0gPT09IHJlcy5pZCl7XG4gICAgICAgICRzY29wZS5zaW5nbGV0b2dnbGVGYXZlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pICAgXG4gIC5jYXRjaChlcnIgPT57XG4gICAgY29uc29sZS5sb2coXCJlcnIgaW4gYnVzaW5lc3NDdHJsOiBcIiwgZXJyKTtcbiAgfSlcblxuICAkc2NvcGUuZmF2b3JpdGUgPSAoKT0+e1xuICAgICAgJHNjb3BlLnNpbmdsZXRvZ2dsZUZhdmUgPSAhJHNjb3BlLnNpbmdsZXRvZ2dsZUZhdmU7XG4gICAgICBVc2VyLmFkZEZhdm9yaXRlVG9Vc2VyKCBQcm9maWxlLl9pZCwgJHNjb3BlLmJ1c2luZXNzLmlkKVxuICAgICAgLnRoZW4oQnVzaW5lc3MuYWRkRmF2b3JpdGUoJHNjb3BlLmJ1c2luZXNzLCBQcm9maWxlLl9pZCkpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJyZXM6XCIgLCByZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KSAgICBcbiAgICB9XG5cblxuICAgICRzY29wZS51bkZhdm9yaXRlID0gKCk9PntcbiAgICAgICRzY29wZS5zaW5nbGV0b2dnbGVGYXZlID0gISRzY29wZS5zaW5nbGV0b2dnbGVGYXZlO1xuICAgICAgVXNlci5yZW1vdmVGYXZvcml0ZWZyb21Vc2VyKCBQcm9maWxlLl9pZCwgJHNjb3BlLmJ1c2luZXNzLmlkKVxuICAgICAgLy8udGhlbihCdXNpbmVzcy5yZW1vdmVGYXZvcml0ZSgkc2NvcGUuYnVzaW5lc3Nlc1tpbmRleF0sIFByb2ZpbGUuX2lkKSlcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkgICAgXG4gICAgfVxuXG59KTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcigndXNlcnNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkJHN0YXRlLCAkc3RhdGUsIFVzZXIpIHtcblxuICB2YXIgdXNlclByb21pc2UgPSBVc2VyLmdldEFsbCgpO1xuICB1c2VyUHJvbWlzZS50aGVuKFxuICAgIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICRzY29wZS51c2VyRmVlZCA9IHJlc3VsdC5kYXRhO1xuICAgIH0pO1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdCdXNpbmVzcycsIGZ1bmN0aW9uKCRodHRwLCAkcSl7XG5cbiAgdGhpcy5nZXRNYXAgPSAoY29yZHMpID0+e1xuICAgIHJldHVybiAkaHR0cC5nZXQoYC9hcGkvYnVzaW5lc3Nlcy9tYXBgLCBjb3JkcylcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgIH0pXG4gIH1cblxuICB0aGlzLnNlYXJjaFllbHAgPSAoc2VhcmNoKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL2J1c2luZXNzZXMveWVscC8ke3NlYXJjaH1gKVxuICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICB0aGlzLnNlYXJjaENhdGFnb3JpZXMgPSAoaW5wdXRzKSA9PntcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS9idXNpbmVzc2VzL3llbHAveWVscENhdGFnb3JpZXNgLCBpbnB1dHMpXG4gICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgfVxuXG4gIHRoaXMuYWRkRmF2b3JpdGUgPSAoYnVzaW5lc3NPYmosIHVzZXJJZCkgPT57XG4gICAgcmV0dXJuICRodHRwLnBvc3QoYC9hcGkvYnVzaW5lc3Nlcy8ke3VzZXJJZH1gLCBidXNpbmVzc09iailcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG59KTtcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdpbWFnZScsIGZ1bmN0aW9uKCRodHRwLCAkcSl7XG5cbiAgdGhpcy5nZXRBbGwgPSAoKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NydWRzJyk7XG4gIH1cblxuICB0aGlzLmdldEJ5SWQgPSBpZCA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL2NydWRzLyR7aWR9YCk7XG4gIH1cblxuICB0aGlzLmFkZENydWQ9IChjcnVkKSA9PntcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS9jcnVkc2AsIGNydWQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcblxuICB0aGlzLmRlbGV0ZUNydWQgPSAoaWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5kZWxldGUoYC9hcGkvY3J1ZHMvJHtpZH1gKVxuICAgICAgLnRoZW4oICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG4gIHRoaXMudXBkYXRlQ3J1ZCA9IChpZCwgY3J1ZCkgPT57XG4gICAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL2NydWRzLyR7aWR9YCwgY3J1ZClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKGNydWQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG5cbn0pO1xuXG4vL2luIHJlc2lkZW50cyBSZXNpZGVudC5nZXRBbGwoKVxuLy8gICAgICAgICAgICAgICAgLnRoZW4ocmVzaWRlbnRzID0+e30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdVc2VyJywgZnVuY3Rpb24oJGh0dHAsICRxKSB7XG5cbiAgdGhpcy5wcm9maWxlID0gKCkgPT4ge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvcHJvZmlsZScpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KTtcbiAgfTtcblxuICB0aGlzLmdldFByb2ZpbGUgPSAoaWQpID0+e1xuICAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuZ2V0QWxsID0gKCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpO1xuICB9XG5cbiAgdGhpcy51cGRhdGVQcm9maWxlID0gKGlkLCBwcm9maWxlT2JqKSA9PntcbiAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gLCAgcHJvZmlsZU9iailcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG5cbiAgdGhpcy5kZWxldGVBY2NvdW50ID0gKGlkKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZGVsZXRlKGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmFkZEZhdm9yaXRlVG9Vc2VyID0gKGlkLCB5ZWxwSWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5wdXQoYC9hcGkvdXNlcnMvcHJvZmlsZS8ke2lkfS9hZGQvJHt5ZWxwSWR9YClcbiAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMucmVtb3ZlRmF2b3JpdGVmcm9tVXNlciA9IChpZCwgeWVscElkKSA9PntcbiAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH0vcmVtb3ZlLyR7eWVscElkfWApXG4gICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cbiBcblxufSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLnNlcnZpY2UoJ1dhbGxQb3N0JywgZnVuY3Rpb24oJGh0dHAsICRxKSB7XG5cbiAgICB0aGlzLmFkZFdhbGxQb3N0PSAod2FsbHBvc3QpID0+e1xuICAgIGNvbnNvbGUubG9nKFwiaW4gYWRkIHdhbGxwb3N0OiBcIiwgd2FsbHBvc3QpO1xuICAgIHJldHVybiAkaHR0cC5wb3N0KGAvYXBpL3dhbGxwb3N0c2AsIHdhbGxwb3N0KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG5cblxuICAgIHRoaXMuZ2V0V2FsbFBvc3RzID0gKHVzZXJJZCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldChgL2FwaS93YWxscG9zdHMvJHt1c2VySWR9YClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOiBcIiwgZXJyKTtcbiAgICAgIH0pO1xuICB9O1xuXG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
