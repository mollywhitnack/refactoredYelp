"use strict";var app=angular.module("myApp",["ui.router","satellizer","ngFileUpload"]);app.config(["$authProvider",function(e){e.loginUrl="api/users/login",e.signupUrl="api/users/signup",e.facebook({clientId:"255060128209165",url:"/api/users/facebook"})}]),app.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"/html/home.html"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}).state("register",{url:"/register",templateUrl:"/html/register.html",controller:"registerCtrl"}).state("profile",{url:"/profile/:userId",templateUrl:"/html/profile.html",controller:"profileCtrl",resolve:{Profile:["User",function(e){return e.profile()}],ProfileByID:["User","$stateParams",function(e,t){return e.getProfile(t.userId)}]}}).state("users",{url:"/users",templateUrl:"/html/users.html",controller:"usersCtrl"}).state("business",{url:"/business",templateUrl:"/html/business.html",controller:"businessCtrl",resolve:{Profile:["User",function(e){return e.profile()}]}}).state("showBusiness",{url:"/business/:businessId",templateUrl:"html/showbusiness.html",controller:"showbusinessCtrl",resolve:{Profile:["User",function(e){return e.profile()}]}}),t.otherwise("/")}]);var app=angular.module("myApp");app.controller("businessCtrl",["$scope","User","$rootScope","Business","Profile",function(e,t,o,n,r){e.businesses=[];var s=r.favorites;e.searchBusiness=function(){n.searchYelp(e.newItem.searchParams).then(function(t){for(var o=0;o<s.length;o++)t.id===s[o]&&(e.toggleFave=!0);e.businesses.push(t)})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.searchBusiness2=function(){var t={};e.newItem.location&&(t.location=e.newItem.location),e.newItem.term&&(t.term=e.newItem.term),n.searchCatagories(t).then(function(t){e.toggleFave=new Array(t.businesses.length);for(var o=0;o<t.businesses.length;o++)for(var n=0;n<s.length;n++)console.log(),t.businesses[o].id===s[n]?e.toggleFave[o]=1:e.toggleFave[o]=0;e.businesses=t.businesses})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.favorite=function(o){e.toggleFave[o]=!e.toggleFave[o],t.addFavoriteToUser(r._id,e.businesses[o].id).then(n.addFavorite(e.businesses[o],r._id)).then(function(e){})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.unFavorite=function(o){e.toggleFave[o]=!e.toggleFave[o],t.removeFavoritefromUser(r._id,e.businesses[o].id).then(function(e){console.log("res:",e)})["catch"](function(e){console.log("err in businessCtrl: ",e)})}}]);var app=angular.module("myApp");app.controller("imageCtrl",["$scope","Upload","Profile","$rootScope",function(e,t,o,n){console.log("image ctrl"),n.currentUser=o,e.submit=function(){console.log("submit"),console.log("$scope.file:",e.file),t.upload({url:"/api/images",data:{photo:e.file,user:n.currentUser._id}}).then(function(t){console.log("res: ",t),e.savedImage=t.data})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("loginCtrl",["$scope","$state","$auth","$rootScope",function(e,t,o,n){console.log("loginCtrl!"),e.login=function(){o.login(e.user).then(function(e){console.log("res: ",e),t.go("profile")})["catch"](function(e){swal({title:"Error!",text:"Invalid Email or Password",type:"error",confirmButtonText:"Ok"})})}}]);var app=angular.module("myApp");app.controller("mainCtrl",["$scope","$state","$auth","$rootScope",function(e,t,o,n){n.currentUser,e.isAuthenticated=function(){return o.isAuthenticated()},e.logout=function(){o.logout(),t.go("home")},e.authenticate=function(e){o.authenticate(e).then(function(e){t.go("home")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("profileCtrl",["$scope","Profile","Business","ProfileByID","$state","User","$rootScope","WallPost",function(e,t,o,n,r,s,l,i){l.currentUser=t,e.user=n||t,i.getWallPosts(e.user._id).then(function(t){e.userWallposts=t}),e.displayFaves=[];for(var u=0;u<t.favorites.length;u++)o.searchYelp(t.favorites[u]).then(function(t){console.log(t),e.displayFaves.push(t)})["catch"](function(e){console.log("err in businessCtrl: ",e)});e.showdisplayNameForm=function(){console.log("show form"),e.displayNameForm=!0},e.updatedisplayName=function(){e.displayNameForm=!1,e.user.displayName=e.newItem.displayName,s.updateProfile(e.user._id,e.newItem).then(function(t){console.log("profile:",t),e.newItem.displayName=""})["catch"](function(e){console.log("err:",e)})},e.canceldisplayName=function(){e.usernameForm=!0,e.newItem.displayName=""},e.showPictureForm=function(){console.log("show form"),e.photoForm=!0},e.updatePicture=function(){e.photoForm=!1,console.log("$state.current: ",r.current),e.user.profileImage=e.newItem.profileImage,console.log("$scope.newItem:",e.newItem),s.updateProfile(e.user._id,e.newItem).then(function(t){console.log("profile:",t),e.newItem.profileImage=""})["catch"](function(e){console.log("err:",e)})},e.cancelPhotoUrl=function(){e.photoForm=!0,e.newItem.photoUrl=""},e.deleteAccount=function(e){console.log(e._id),s.deleteAccount(e._id).then()["catch"](function(e){console.log("err: ",e)})},e.submitMessage=function(){var t={to:e.user,from:l.currentUser._id,fromName:l.currentUser.displayName,text:e.newItem.text,createdAt:"add moment"};i.addWallPost(t).then(function(e){s.addWallPostToUser(n._id,e._id)}).then(r.go(r.$current,null,{reload:!0}))["catch"](function(e){console.log("err: ",e)})}}]);var app=angular.module("myApp");app.controller("registerCtrl",["$scope","$state","$auth",function(e,t,o){console.log("registerCtrl!"),e.register=function(){e.user.password!==e.user.password2?(e.user.password=null,e.user.password2=null,alert("Passwords must match!")):o.signup(e.user).then(function(e){console.log("res: ",e),t.go("login")})["catch"](function(e){swal({title:"Error!",text:"Invalid Email or Password",type:"error",confirmButtonText:"Ok"})})}}]);var app=angular.module("myApp");app.controller("showbusinessCtrl",["$scope","$stateParams","Business","Profile","User",function(e,t,o,n,r){e.showButton=!1,e.singletoggleFave=!1;var s=n.favorites,l=t;o.searchYelp(l.businessId).then(function(t){e.business=t,e.showButton=!0;for(var o=0;o<s.length;o++)s[o]===t.id&&(e.singletoggleFave=!0)})["catch"](function(e){console.log("err in businessCtrl: ",e)}),e.favorite=function(){e.singletoggleFave=!e.singletoggleFave,r.addFavoriteToUser(n._id,e.business.id).then(o.addFavorite(e.business,n._id)).then(function(e){})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.unFavorite=function(){e.singletoggleFave=!e.singletoggleFave,r.removeFavoritefromUser(n._id,e.business.id).then(function(e){})["catch"](function(e){console.log("err in businessCtrl: ",e)})}}]);var app=angular.module("myApp");app.controller("usersCtrl",["$scope","$$state","$state","User",function(e,t,o,n){var r=n.getAll();r.then(function(t){e.userFeed=t.data})}]);var app=angular.module("myApp");app.service("Business",["$http","$q",function(e,t){this.getMap=function(o){return e.get("/api/businesses/map",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.searchYelp=function(o){return e.get("/api/businesses/yelp/"+o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.searchCatagories=function(o){return e.post("/api/businesses/yelp/yelpCatagories",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.addFavorite=function(o,n){return e.post("/api/businesses/"+n,o).then(function(e){return t.resolve(e)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("image",["$http","$q",function(e,t){this.getAll=function(){return e.get("/api/cruds")},this.getById=function(t){return e.get("/api/cruds/"+t)},this.addCrud=function(o){return e.post("/api/cruds",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.deleteCrud=function(o){return e["delete"]("/api/cruds/"+o).then(function(){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.updateCrud=function(o,n){return e.put("/api/cruds/"+o,n).then(function(e){return t.resolve(n)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("User",["$http","$q",function(e,t){this.profile=function(){return e.get("/api/users/profile").then(function(e){return t.resolve(e.data)})},this.getProfile=function(o){return e.get("/api/users/profile/"+o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getAll=function(){return e.get("/api/users")},this.updateProfile=function(o,n){return e.put("/api/users/profile/"+o,n).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.deleteAccount=function(o){return e["delete"]("/api/users/profile/"+o).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.addFavoriteToUser=function(o,n){return e.put("/api/users/profile/"+o+"/add/"+n).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})},this.removeFavoritefromUser=function(o,n){return e.put("/api/users/profile/"+o+"/remove/"+n).then(function(e){return t.resolve()})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("WallPost",["$http","$q",function(e,t){this.addWallPost=function(o){return console.log("in add wallpost: ",o),e.post("/api/wallposts",o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getWallPosts=function(o){return e.get("/api/wallposts/"+o).then(function(e){return t.resolve(e.data)})["catch"](function(e){console.log("err: ",e)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2J1c2luZXNzQ3RybC5qcyIsImNvbnRyb2xsZXJzL2ltYWdlQ3RybC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL21haW5DdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUN0cmwuanMiLCJjb250cm9sbGVycy9yZWdpc3RlckN0cmwuanMiLCJjb250cm9sbGVycy9zaG93YnVzaW5lc3NDdHJsLmpzIiwiY29udHJvbGxlcnMvdXNlcnNDdHJsLmpzIiwic2VydmljZXMvYnVzaW5lc3NzZXJ2aWNlcy5qcyIsInNlcnZpY2VzL2ltYWdlc2VydmljZXMuanMiLCJzZXJ2aWNlcy91c2Vyc2VydmljZXMuanMiLCJzZXJ2aWNlcy93YWxscG9zdHNlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkYXV0aFByb3ZpZGVyIiwibG9naW5VcmwiLCJzaWdudXBVcmwiLCJmYWNlYm9vayIsImNsaWVudElkIiwidXJsIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInJlc29sdmUiLCJQcm9maWxlIiwiVXNlciIsInByb2ZpbGUiLCJQcm9maWxlQnlJRCIsIiRzdGF0ZVBhcmFtcyIsImdldFByb2ZpbGUiLCJ1c2VySWQiLCJvdGhlcndpc2UiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiQnVzaW5lc3MiLCJidXNpbmVzc2VzIiwiZmF2b3JpdGVzIiwic2VhcmNoQnVzaW5lc3MiLCJzZWFyY2hZZWxwIiwibmV3SXRlbSIsInNlYXJjaFBhcmFtcyIsInRoZW4iLCJyZXMiLCJpIiwibGVuZ3RoIiwiaWQiLCJ0b2dnbGVGYXZlIiwicHVzaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJzZWFyY2hCdXNpbmVzczIiLCJzZWFyY2hCeSIsImxvY2F0aW9uIiwidGVybSIsInNlYXJjaENhdGFnb3JpZXMiLCJBcnJheSIsImsiLCJmYXZvcml0ZSIsImluZGV4IiwiYWRkRmF2b3JpdGVUb1VzZXIiLCJfaWQiLCJhZGRGYXZvcml0ZSIsInVuRmF2b3JpdGUiLCJyZW1vdmVGYXZvcml0ZWZyb21Vc2VyIiwiVXBsb2FkIiwiY3VycmVudFVzZXIiLCJzdWJtaXQiLCJmaWxlIiwidXBsb2FkIiwiZGF0YSIsInBob3RvIiwidXNlciIsInNhdmVkSW1hZ2UiLCIkc3RhdGUiLCIkYXV0aCIsImxvZ2luIiwiZ28iLCJzd2FsIiwidGl0bGUiLCJ0ZXh0IiwidHlwZSIsImNvbmZpcm1CdXR0b25UZXh0IiwiaXNBdXRoZW50aWNhdGVkIiwibG9nb3V0IiwiYXV0aGVudGljYXRlIiwicHJvdmlkZXIiLCJXYWxsUG9zdCIsImdldFdhbGxQb3N0cyIsInVzZXJXYWxscG9zdHMiLCJkaXNwbGF5RmF2ZXMiLCJzaG93ZGlzcGxheU5hbWVGb3JtIiwiZGlzcGxheU5hbWVGb3JtIiwidXBkYXRlZGlzcGxheU5hbWUiLCJkaXNwbGF5TmFtZSIsInVwZGF0ZVByb2ZpbGUiLCJjYW5jZWxkaXNwbGF5TmFtZSIsInVzZXJuYW1lRm9ybSIsInNob3dQaWN0dXJlRm9ybSIsInBob3RvRm9ybSIsInVwZGF0ZVBpY3R1cmUiLCJjdXJyZW50IiwicHJvZmlsZUltYWdlIiwiY2FuY2VsUGhvdG9VcmwiLCJwaG90b1VybCIsImRlbGV0ZUFjY291bnQiLCJzdWJtaXRNZXNzYWdlIiwicG9zdE9iaiIsInRvIiwiZnJvbSIsImZyb21OYW1lIiwiY3JlYXRlZEF0IiwiYWRkV2FsbFBvc3QiLCJ3YWxscG9zdCIsImFkZFdhbGxQb3N0VG9Vc2VyIiwiJGN1cnJlbnQiLCJyZWxvYWQiLCJyZWdpc3RlciIsInBhc3N3b3JkIiwicGFzc3dvcmQyIiwiYWxlcnQiLCJzaWdudXAiLCJzaG93QnV0dG9uIiwic2luZ2xldG9nZ2xlRmF2ZSIsImJ1c2luZXNzSWQiLCJidXNpbmVzcyIsIiQkc3RhdGUiLCJ1c2VyUHJvbWlzZSIsImdldEFsbCIsInJlc3VsdCIsInVzZXJGZWVkIiwic2VydmljZSIsIiRodHRwIiwiJHEiLCJ0aGlzIiwiZ2V0TWFwIiwiY29yZHMiLCJnZXQiLCJzZWFyY2giLCJpbnB1dHMiLCJwb3N0IiwiYnVzaW5lc3NPYmoiLCJnZXRCeUlkIiwiYWRkQ3J1ZCIsImNydWQiLCJkZWxldGVDcnVkIiwidXBkYXRlQ3J1ZCIsInB1dCIsInByb2ZpbGVPYmoiLCJ5ZWxwSWQiXSwibWFwcGluZ3MiOiJBQUFBLFlBRUEsSUFBSUEsS0FBTUMsUUFBUUMsT0FBTyxTQUFVLFlBQWEsYUFBYyxnQkFFOURGLEtBQUlHLFFBQUEsZ0JBQU8sU0FBU0MsR0FFbEJBLEVBQWNDLFNBQVcsa0JBQ3pCRCxFQUFjRSxVQUFZLG1CQUUxQkYsRUFBY0csVUFDWkMsU0FBVSxrQkFDVkMsSUFBSywyQkFLVFQsSUFBSUcsUUFBQSxpQkFBQSxxQkFBTyxTQUFTTyxFQUFnQkMsR0FFbENELEVBQ0dFLE1BQU0sUUFBVUgsSUFBSyxJQUFLSSxZQUFhLG9CQUN2Q0QsTUFBTSxTQUNMSCxJQUFLLFNBQ0xJLFlBQWEsbUJBQ2JDLFdBQVksY0FFYkYsTUFBTSxZQUNMSCxJQUFLLFlBQ0xJLFlBQWEsc0JBQ2JDLFdBQVksaUJBRWJGLE1BQU0sV0FDTEgsSUFBSyxtQkFDTEksWUFBYSxxQkFDYkMsV0FBWSxjQUNaQyxTQUNFQyxTQUFBLE9BQVMsU0FBU0MsR0FDaEIsTUFBT0EsR0FBS0MsWUFFZEMsYUFBQSxPQUFBLGVBQWEsU0FBU0YsRUFBTUcsR0FDMUIsTUFBT0gsR0FBS0ksV0FBV0QsRUFBYUUsYUFJekNWLE1BQU0sU0FDTEgsSUFBSyxTQUNMSSxZQUFhLG1CQUNiQyxXQUFZLGNBRWJGLE1BQU0sWUFDTEgsSUFBSyxZQUNMSSxZQUFhLHNCQUNiQyxXQUFZLGVBQ1pDLFNBQ0VDLFNBQUEsT0FBUyxTQUFTQyxHQUNoQixNQUFPQSxHQUFLQyxlQUlqQk4sTUFBTSxnQkFDTEgsSUFBSyx3QkFDTEksWUFBYSx5QkFDYkMsV0FBWSxtQkFDWkMsU0FDRUMsU0FBQSxP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LEtBQUssU0FBQUMsR0FDSixNQUFPMkYsR0FBRzlHLFFBQVFtQixFQUFJNEIsUUFGbkI4RCxTQUlFLFNBQUFwRixHQUNMQyxRQUFRQyxJQUFJLFFBQVNGIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcsIFsndWkucm91dGVyJywgJ3NhdGVsbGl6ZXInLCAnbmdGaWxlVXBsb2FkJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uKCRhdXRoUHJvdmlkZXIpIHtcblxuICAkYXV0aFByb3ZpZGVyLmxvZ2luVXJsID0gJ2FwaS91c2Vycy9sb2dpbic7XG4gICRhdXRoUHJvdmlkZXIuc2lnbnVwVXJsID0gJ2FwaS91c2Vycy9zaWdudXAnO1xuXG4gICRhdXRoUHJvdmlkZXIuZmFjZWJvb2soe1xuICAgIGNsaWVudElkOiAnMjU1MDYwMTI4MjA5MTY1JyxcbiAgICB1cmw6ICcvYXBpL3VzZXJzL2ZhY2Vib29rJ1xuICB9KTtcblxufSk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gICRzdGF0ZVByb3ZpZGVyXG4gICAgLnN0YXRlKCdob21lJywgeyB1cmw6ICcvJywgdGVtcGxhdGVVcmw6ICcvaHRtbC9ob21lLmh0bWwnIH0pXG4gICAgLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2xvZ2luLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICB9KVxuICAgIC5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9yZWdpc3Rlci5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdyZWdpc3RlckN0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2ZpbGUnLCB7XG4gICAgICB1cmw6ICcvcHJvZmlsZS86dXNlcklkJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlQ3RybCcsXG4gICAgICByZXNvbHZlOiB7XG4gICAgICAgIFByb2ZpbGU6IGZ1bmN0aW9uKFVzZXIpIHtcbiAgICAgICAgICByZXR1cm4gVXNlci5wcm9maWxlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIFByb2ZpbGVCeUlEOiBmdW5jdGlvbihVc2VyLCAkc3RhdGVQYXJhbXMpe1xuICAgICAgICAgIHJldHVybiBVc2VyLmdldFByb2ZpbGUoJHN0YXRlUGFyYW1zLnVzZXJJZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICAgIC5zdGF0ZSgndXNlcnMnLCB7XG4gICAgICB1cmw6ICcvdXNlcnMnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC91c2Vycy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICd1c2Vyc0N0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ2J1c2luZXNzJywge1xuICAgICAgdXJsOiAnL2J1c2luZXNzJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvYnVzaW5lc3MuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnYnVzaW5lc3NDdHJsJyxcbiAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgUHJvZmlsZTogZnVuY3Rpb24oVXNlcikge1xuICAgICAgICAgIHJldHVybiBVc2VyLnByb2ZpbGUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgLnN0YXRlKCdzaG93QnVzaW5lc3MnLCB7XG4gICAgICB1cmw6ICcvYnVzaW5lc3MvOmJ1c2luZXNzSWQnLCBcbiAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC9zaG93YnVzaW5lc3MuaHRtbCcsIFxuICAgICAgY29udHJvbGxlcjogJ3Nob3didXNpbmVzc0N0cmwnLCAgICAgIFxuICAgICAgcmVzb2x2ZToge1xuICAgICAgICBQcm9maWxlOiBmdW5jdGlvbihVc2VyKSB7XG4gICAgICAgICAgcmV0dXJuIFVzZXIucHJvZmlsZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB9KVxuICAgIFxuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG59KTtcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdidXNpbmVzc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXIsICRyb290U2NvcGUsIEJ1c2luZXNzLCBQcm9maWxlKXtcblxuICAkc2NvcGUuYnVzaW5lc3NlcyA9IFtdO1xuICB2YXIgZmF2b3JpdGVzID0gUHJvZmlsZS5mYXZvcml0ZXM7XG5cbiAgJHNjb3BlLnNlYXJjaEJ1c2luZXNzID0gKCkgPT4ge1xuICAgICAgQnVzaW5lc3Muc2VhcmNoWWVscCgkc2NvcGUubmV3SXRlbS5zZWFyY2hQYXJhbXMpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPCBmYXZvcml0ZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgIGlmKHJlcy5pZCA9PT0gZmF2b3JpdGVzW2ldKXtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVGYXZlID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLmJ1c2luZXNzZXMucHVzaChyZXMpO1xuICAgICAgfSkgICAgXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9XG5cbiAgJHNjb3BlLnNlYXJjaEJ1c2luZXNzMiA9ICgpID0+IHtcbiAgICAgIHZhciBzZWFyY2hCeSA9IHt9O1xuICAgICAgaWYoJHNjb3BlLm5ld0l0ZW0ubG9jYXRpb24pe1xuICAgICAgICBzZWFyY2hCeS5sb2NhdGlvbiA9ICRzY29wZS5uZXdJdGVtLmxvY2F0aW9uXG4gICAgICB9XG4gICAgICBpZigkc2NvcGUubmV3SXRlbS50ZXJtKXtcbiAgICAgICAgc2VhcmNoQnkudGVybSA9ICRzY29wZS5uZXdJdGVtLnRlcm07XG4gICAgICB9XG5cbiAgICAgIEJ1c2luZXNzLnNlYXJjaENhdGFnb3JpZXMoc2VhcmNoQnkpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgICRzY29wZS50b2dnbGVGYXZlID0gbmV3IEFycmF5KHJlcy5idXNpbmVzc2VzLmxlbmd0aClcblxuICAgICAgICAvL2NoZWNrIGZvciBmYXZvcml0ZXNcbiAgICAgICAgZm9yKHZhciBrPTA7IGs8cmVzLmJ1c2luZXNzZXMubGVuZ3RoOyBrKyspe1xuICAgICAgICAgIGZvcih2YXIgaT0wOyBpPCBmYXZvcml0ZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgY29uc29sZS5sb2coKVxuICAgICAgICAgICAgaWYocmVzLmJ1c2luZXNzZXNba10uaWQgPT09IGZhdm9yaXRlc1tpXSl7XG4gICAgICAgICAgICAgICRzY29wZS50b2dnbGVGYXZlW2tdID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgJHNjb3BlLnRvZ2dsZUZhdmVba10gPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuYnVzaW5lc3NlcyA9IHJlcy5idXNpbmVzc2VzO1xuXG4gICAgICB9KSAgICBcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KVxuICAgIH1cblxuXG4gICAgLy9hZGQgdG8gdXNlciBmYXZvcml0ZXNcbiAgICAkc2NvcGUuZmF2b3JpdGUgPSAoaW5kZXgpPT57XG4gICAgICAkc2NvcGUudG9nZ2xlRmF2ZVtpbmRleF0gPSAhJHNjb3BlLnRvZ2dsZUZhdmVbaW5kZXhdO1xuICAgICAgVXNlci5hZGRGYXZvcml0ZVRvVXNlciggUHJvZmlsZS5faWQsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZClcbiAgICAgIC50aGVuKEJ1c2luZXNzLmFkZEZhdm9yaXRlKCRzY29wZS5idXNpbmVzc2VzW2luZGV4XSwgUHJvZmlsZS5faWQpKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkgICAgXG4gICAgfVxuXG4gICAgJHNjb3BlLnVuRmF2b3JpdGUgPSAoaW5kZXgpPT57XG4gICAgICAkc2NvcGUudG9nZ2xlRmF2ZVtpbmRleF0gPSAhJHNjb3BlLnRvZ2dsZUZhdmVbaW5kZXhdO1xuICAgICAgVXNlci5yZW1vdmVGYXZvcml0ZWZyb21Vc2VyKCBQcm9maWxlLl9pZCwgJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkKVxuICAgICAgLy8udGhlbihCdXNpbmVzcy5yZW1vdmVGYXZvcml0ZSgkc2NvcGUuYnVzaW5lc3Nlc1tpbmRleF0sIFByb2ZpbGUuX2lkKSlcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXM6XCIgLCByZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KSAgICBcbiAgICB9XG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignaW1hZ2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVcGxvYWQsIFByb2ZpbGUsICRyb290U2NvcGUpIHtcbiAgY29uc29sZS5sb2coXCJpbWFnZSBjdHJsXCIpO1xuXG5cbiAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IFByb2ZpbGU7XG5cbiAgJHNjb3BlLnN1Ym1pdCA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKCdzdWJtaXQnKTtcbiAgICBjb25zb2xlLmxvZygnJHNjb3BlLmZpbGU6JywgJHNjb3BlLmZpbGUpO1xuICAgIFxuICAgIFVwbG9hZC51cGxvYWQoe1xuICAgICAgdXJsOiAnL2FwaS9pbWFnZXMnLFxuICAgICAgZGF0YToge3Bob3RvOiAkc2NvcGUuZmlsZSwgdXNlcjogJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWR9IC8vYW55dGhpbmcgZWxzZSBsaWtlIG5hbWUgd2lsbCBlbmQgdXAgaW4gcmVxLmJvZHlcbiAgICB9KVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcyk7XG4gICAgICAkc2NvcGUuc2F2ZWRJbWFnZSA9IHJlcy5kYXRhO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpXG4gICAgfSlcbiAgfTtcblxufSk7XG5cblxuIiwiXG4ndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkYXV0aCwgJHJvb3RTY29wZSkge1xuICBjb25zb2xlLmxvZygnbG9naW5DdHJsIScpO1xuXG4gICRzY29wZS5sb2dpbiA9ICgpID0+IHtcbiAgICAgICRhdXRoLmxvZ2luKCRzY29wZS51c2VyKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlczogXCIsIHJlcyk7XG4gICAgICAgIC8vJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhO1xuICAgICAgICAkc3RhdGUuZ28oJ3Byb2ZpbGUnKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgICBzd2FsKHsgICB0aXRsZTogXCJFcnJvciFcIiwgICB0ZXh0OiBcIkludmFsaWQgRW1haWwgb3IgUGFzc3dvcmRcIiwgICB0eXBlOiBcImVycm9yXCIsICAgY29uZmlybUJ1dHRvblRleHQ6IFwiT2tcIiB9KTtcbiAgICAgIH0pXG4gICAgfTtcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignbWFpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgJGF1dGgsICRyb290U2NvcGUpIHtcblxuICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyO1xuXG4gICRzY29wZS5pc0F1dGhlbnRpY2F0ZWQgPSAoKSA9PiAkYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKTtcblxuICAkc2NvcGUubG9nb3V0ID0gKCkgPT4ge1xuICAgICRhdXRoLmxvZ291dCgpO1xuICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICB9O1xuXG4gICRzY29wZS5hdXRoZW50aWNhdGUgPSBwcm92aWRlciA9PiB7XG4gICAgJGF1dGguYXV0aGVudGljYXRlKHByb3ZpZGVyKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gIH07XG59KTtcbiIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcigncHJvZmlsZUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFByb2ZpbGUsIEJ1c2luZXNzLCBQcm9maWxlQnlJRCwgJHN0YXRlLCBVc2VyLCAkcm9vdFNjb3BlLCBXYWxsUG9zdCkge1xuICBcbiAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IFByb2ZpbGU7XG5cbiAgJHNjb3BlLnVzZXIgPSBQcm9maWxlQnlJRCB8fCBQcm9maWxlO1xuXG4gIFdhbGxQb3N0LmdldFdhbGxQb3N0cygkc2NvcGUudXNlci5faWQpXG4gICAgLnRoZW4ocmVzID0+e1xuICAgICRzY29wZS51c2VyV2FsbHBvc3RzID0gcmVzO1xuICB9KVxuXG4gICRzY29wZS5kaXNwbGF5RmF2ZXMgPSBbXTtcblxuICBmb3IodmFyIGkgPTA7IGk8IFByb2ZpbGUuZmF2b3JpdGVzLmxlbmd0aDsgaSsrKXtcbiAgICBCdXNpbmVzcy5zZWFyY2hZZWxwKFByb2ZpbGUuZmF2b3JpdGVzW2ldKVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICAkc2NvcGUuZGlzcGxheUZhdmVzLnB1c2gocmVzKTtcbiAgICB9KSAgIFxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgIH0pXG4gIH0gXG5cbiAgJHNjb3BlLnNob3dkaXNwbGF5TmFtZUZvcm0gPSAoKSA9PntcbiAgICBjb25zb2xlLmxvZyhcInNob3cgZm9ybVwiKTtcbiAgICAkc2NvcGUuZGlzcGxheU5hbWVGb3JtID0gdHJ1ZTtcbiAgfVxuXG4gICRzY29wZS51cGRhdGVkaXNwbGF5TmFtZSA9ICgpID0+IHtcbiAgICAkc2NvcGUuZGlzcGxheU5hbWVGb3JtID0gZmFsc2U7XG4gICAgJHNjb3BlLnVzZXIuZGlzcGxheU5hbWUgPSAkc2NvcGUubmV3SXRlbS5kaXNwbGF5TmFtZTtcbiAgICBVc2VyLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLnVzZXIuX2lkLCAkc2NvcGUubmV3SXRlbSlcbiAgICAgIC50aGVuKHByb2ZpbGUgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZTpcIiwgcHJvZmlsZSk7XG4gICAgICAgICRzY29wZS5uZXdJdGVtLmRpc3BsYXlOYW1lID0gJyc7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICB9KVxuICB9XG5cbiAgJHNjb3BlLmNhbmNlbGRpc3BsYXlOYW1lID0gKCkgPT57XG4gICAgJHNjb3BlLnVzZXJuYW1lRm9ybSA9IHRydWU7XG4gICAgJHNjb3BlLm5ld0l0ZW0uZGlzcGxheU5hbWUgPSAnJztcbiAgfVxuXG4vL3Bob3RvXG4gICRzY29wZS5zaG93UGljdHVyZUZvcm0gPSAoKSA9PntcbiAgICBjb25zb2xlLmxvZyhcInNob3cgZm9ybVwiKTtcbiAgICAkc2NvcGUucGhvdG9Gb3JtID0gdHJ1ZTtcbiAgfVxuXG4gICRzY29wZS51cGRhdGVQaWN0dXJlID0gKCkgPT4ge1xuICAgICRzY29wZS5waG90b0Zvcm0gPSBmYWxzZTtcbiAgICBjb25zb2xlLmxvZyhcIiRzdGF0ZS5jdXJyZW50OiBcIiwgJHN0YXRlLmN1cnJlbnQpO1xuICAgICRzY29wZS51c2VyLnByb2ZpbGVJbWFnZSA9ICRzY29wZS5uZXdJdGVtLnByb2ZpbGVJbWFnZTtcbiAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5uZXdJdGVtOlwiLCAkc2NvcGUubmV3SXRlbSk7XG4gICAgVXNlci51cGRhdGVQcm9maWxlKCRzY29wZS51c2VyLl9pZCwgJHNjb3BlLm5ld0l0ZW0pXG4gICAgICAudGhlbihwcm9maWxlID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInByb2ZpbGU6XCIsIHByb2ZpbGUpO1xuICAgICAgICAkc2NvcGUubmV3SXRlbS5wcm9maWxlSW1hZ2UgPSAnJztcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICAkc2NvcGUuY2FuY2VsUGhvdG9VcmwgPSAoKSA9PntcbiAgICAkc2NvcGUucGhvdG9Gb3JtID0gdHJ1ZTtcbiAgICAkc2NvcGUubmV3SXRlbS5waG90b1VybCA9ICcnO1xuICB9XG5cblxuICAkc2NvcGUuZGVsZXRlQWNjb3VudCA9ICh1c2VyKSA9PntcbiAgICAvL2FkZCBzd2FsXG4gICAgY29uc29sZS5sb2codXNlci5faWQpO1xuICAgIFVzZXIuZGVsZXRlQWNjb3VudCh1c2VyLl9pZClcbiAgICAgIC50aGVuKClcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOiBcIiwgZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgICAkc2NvcGUuc3VibWl0TWVzc2FnZSA9ICgpID0+e1xuXG4gICAgdmFyIHBvc3RPYmogPSB7XG4gICAgICB0bzogJHNjb3BlLnVzZXIsXG4gICAgICBmcm9tOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLl9pZCxcbiAgICAgIGZyb21OYW1lOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lLFxuICAgICAgdGV4dDogJHNjb3BlLm5ld0l0ZW0udGV4dCxcbiAgICAgIGNyZWF0ZWRBdDogXCJhZGQgbW9tZW50XCJcbiAgICB9O1xuXG5cbiAgICBXYWxsUG9zdC5hZGRXYWxsUG9zdChwb3N0T2JqKVxuICAgICAgLnRoZW4od2FsbHBvc3QgPT57XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJ3YWxscG9zdDpcIiAsIHdhbGxwb3N0KTtcbiAgICAgICAgVXNlci5hZGRXYWxsUG9zdFRvVXNlcihQcm9maWxlQnlJRC5faWQsIHdhbGxwb3N0Ll9pZCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oJHN0YXRlLmdvKCRzdGF0ZS4kY3VycmVudCwgbnVsbCwgeyByZWxvYWQ6IHRydWUgfSkpXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjogXCIsIGVycik7XG4gICAgICB9KVxuICAgfTtcblxuXG59KTsiLCIndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkYXV0aCkge1xuICBjb25zb2xlLmxvZygncmVnaXN0ZXJDdHJsIScpO1xuXG4gICRzY29wZS5yZWdpc3RlciA9ICgpID0+IHtcbiAgICBpZigkc2NvcGUudXNlci5wYXNzd29yZCAhPT0gJHNjb3BlLnVzZXIucGFzc3dvcmQyKXtcbiAgICAgICRzY29wZS51c2VyLnBhc3N3b3JkID0gbnVsbDtcbiAgICAgICRzY29wZS51c2VyLnBhc3N3b3JkMiA9IG51bGw7XG4gICAgICBhbGVydCgnUGFzc3dvcmRzIG11c3QgbWF0Y2ghJyk7XG4gICAgfWVsc2V7XG4gICAgICAkYXV0aC5zaWdudXAoJHNjb3BlLnVzZXIpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOiBcIiwgcmVzKTtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICAgIHN3YWwoeyAgIHRpdGxlOiBcIkVycm9yIVwiLCAgIHRleHQ6IFwiSW52YWxpZCBFbWFpbCBvciBQYXNzd29yZFwiLCAgIHR5cGU6IFwiZXJyb3JcIiwgICBjb25maXJtQnV0dG9uVGV4dDogXCJPa1wiIH0pO1xuICAgICAgfSlcbiAgICB9XG4gIH07XG59KTsiLCIndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuXG5hcHAuY29udHJvbGxlcignc2hvd2J1c2luZXNzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlUGFyYW1zLCBCdXNpbmVzcywgUHJvZmlsZSwgVXNlcikge1xuXG4gICRzY29wZS5zaG93QnV0dG9uID0gZmFsc2U7XG4gICRzY29wZS5zaW5nbGV0b2dnbGVGYXZlID0gZmFsc2U7XG4gIHZhciBmYXZvcml0ZXMgPSBQcm9maWxlLmZhdm9yaXRlcztcblxuICBsZXQgYnVzaW5lc3NJZCA9ICRzdGF0ZVBhcmFtcztcblxuICBCdXNpbmVzcy5zZWFyY2hZZWxwKGJ1c2luZXNzSWQuYnVzaW5lc3NJZClcbiAgLnRoZW4ocmVzID0+e1xuICAgICRzY29wZS5idXNpbmVzcyA9IHJlcztcbiAgICAkc2NvcGUuc2hvd0J1dHRvbiA9IHRydWU7XG4gICAgZm9yKHZhciBpID0wOyBpPCBmYXZvcml0ZXMubGVuZ3RoOyBpKyspe1xuICAgICAgaWYoZmF2b3JpdGVzW2ldID09PSByZXMuaWQpe1xuICAgICAgICAkc2NvcGUuc2luZ2xldG9nZ2xlRmF2ZSA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9KSAgIFxuICAuY2F0Y2goZXJyID0+e1xuICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gIH0pXG5cbiAgJHNjb3BlLmZhdm9yaXRlID0gKCk9PntcbiAgICAgICRzY29wZS5zaW5nbGV0b2dnbGVGYXZlID0gISRzY29wZS5zaW5nbGV0b2dnbGVGYXZlO1xuICAgICAgVXNlci5hZGRGYXZvcml0ZVRvVXNlciggUHJvZmlsZS5faWQsICRzY29wZS5idXNpbmVzcy5pZClcbiAgICAgIC50aGVuKEJ1c2luZXNzLmFkZEZhdm9yaXRlKCRzY29wZS5idXNpbmVzcywgUHJvZmlsZS5faWQpKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkgICAgXG4gICAgfVxuXG5cbiAgICAkc2NvcGUudW5GYXZvcml0ZSA9ICgpPT57XG4gICAgICAkc2NvcGUuc2luZ2xldG9nZ2xlRmF2ZSA9ICEkc2NvcGUuc2luZ2xldG9nZ2xlRmF2ZTtcbiAgICAgIFVzZXIucmVtb3ZlRmF2b3JpdGVmcm9tVXNlciggUHJvZmlsZS5faWQsICRzY29wZS5idXNpbmVzcy5pZClcbiAgICAgIC8vLnRoZW4oQnVzaW5lc3MucmVtb3ZlRmF2b3JpdGUoJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLCBQcm9maWxlLl9pZCkpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnIgaW4gYnVzaW5lc3NDdHJsOiBcIiwgZXJyKTtcbiAgICAgIH0pICAgIFxuICAgIH1cblxufSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3VzZXJzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJCRzdGF0ZSwgJHN0YXRlLCBVc2VyKSB7XG5cbiAgdmFyIHVzZXJQcm9taXNlID0gVXNlci5nZXRBbGwoKTtcbiAgdXNlclByb21pc2UudGhlbihcbiAgICBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAkc2NvcGUudXNlckZlZWQgPSByZXN1bHQuZGF0YTtcbiAgICB9KTtcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuc2VydmljZSgnQnVzaW5lc3MnLCBmdW5jdGlvbigkaHR0cCwgJHEpe1xuXG4gIHRoaXMuZ2V0TWFwID0gKGNvcmRzKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL2J1c2luZXNzZXMvbWFwYCwgY29yZHMpXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICB9KVxuICB9XG5cbiAgdGhpcy5zZWFyY2hZZWxwID0gKHNlYXJjaCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldChgL2FwaS9idXNpbmVzc2VzL3llbHAvJHtzZWFyY2h9YClcbiAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICB9XG5cbiAgdGhpcy5zZWFyY2hDYXRhZ29yaWVzID0gKGlucHV0cykgPT57XG4gICAgcmV0dXJuICRodHRwLnBvc3QoYC9hcGkvYnVzaW5lc3Nlcy95ZWxwL3llbHBDYXRhZ29yaWVzYCwgaW5wdXRzKVxuICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICB0aGlzLmFkZEZhdm9yaXRlID0gKGJ1c2luZXNzT2JqLCB1c2VySWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5wb3N0KGAvYXBpL2J1c2luZXNzZXMvJHt1c2VySWR9YCwgYnVzaW5lc3NPYmopXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xufSk7XG5cbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuc2VydmljZSgnaW1hZ2UnLCBmdW5jdGlvbigkaHR0cCwgJHEpe1xuXG4gIHRoaXMuZ2V0QWxsID0gKCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jcnVkcycpO1xuICB9XG5cbiAgdGhpcy5nZXRCeUlkID0gaWQgPT57XG4gICAgcmV0dXJuICRodHRwLmdldChgL2FwaS9jcnVkcy8ke2lkfWApO1xuICB9XG5cbiAgdGhpcy5hZGRDcnVkPSAoY3J1ZCkgPT57XG4gICAgcmV0dXJuICRodHRwLnBvc3QoYC9hcGkvY3J1ZHNgLCBjcnVkKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG5cbiAgdGhpcy5kZWxldGVDcnVkID0gKGlkKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZGVsZXRlKGAvYXBpL2NydWRzLyR7aWR9YClcbiAgICAgIC50aGVuKCAoKSA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcblxuICB0aGlzLnVwZGF0ZUNydWQgPSAoaWQsIGNydWQpID0+e1xuICAgICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS9jcnVkcy8ke2lkfWAsIGNydWQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShjcnVkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG59KTtcblxuLy9pbiByZXNpZGVudHMgUmVzaWRlbnQuZ2V0QWxsKClcbi8vICAgICAgICAgICAgICAgIC50aGVuKHJlc2lkZW50cyA9Pnt9KSIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuc2VydmljZSgnVXNlcicsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuXG4gIHRoaXMucHJvZmlsZSA9ICgpID0+IHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzL3Byb2ZpbGUnKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgdGhpcy5nZXRQcm9maWxlID0gKGlkKSA9PntcbiAgICAgcmV0dXJuICRodHRwLmdldChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YClcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmdldEFsbCA9ICgpID0+e1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKTtcbiAgfVxuXG4gIHRoaXMudXBkYXRlUHJvZmlsZSA9IChpZCwgcHJvZmlsZU9iaikgPT57XG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YCwgIHByb2ZpbGVPYmopXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuZGVsZXRlQWNjb3VudCA9IChpZCkgPT57XG4gICAgcmV0dXJuICRodHRwLmRlbGV0ZShgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YClcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG5cbiAgdGhpcy5hZGRGYXZvcml0ZVRvVXNlciA9IChpZCwgeWVscElkKSA9PntcbiAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH0vYWRkLyR7eWVscElkfWApXG4gICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLnJlbW92ZUZhdm9yaXRlZnJvbVVzZXIgPSAoaWQsIHllbHBJZCkgPT57XG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9L3JlbW92ZS8ke3llbHBJZH1gKVxuICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG4gXG5cbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdXYWxsUG9zdCcsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuXG4gICAgdGhpcy5hZGRXYWxsUG9zdD0gKHdhbGxwb3N0KSA9PntcbiAgICBjb25zb2xlLmxvZyhcImluIGFkZCB3YWxscG9zdDogXCIsIHdhbGxwb3N0KTtcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS93YWxscG9zdHNgLCB3YWxscG9zdClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG5cbiAgICB0aGlzLmdldFdhbGxQb3N0cyA9ICh1c2VySWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5nZXQoYC9hcGkvd2FsbHBvc3RzLyR7dXNlcklkfWApXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVycj0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjogXCIsIGVycik7XG4gICAgICB9KTtcbiAgfTtcblxufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
