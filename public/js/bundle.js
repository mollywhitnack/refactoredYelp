"use strict";var app=angular.module("myApp",["ui.router","satellizer","ngFileUpload"]);app.config(["$authProvider",function(e){e.loginUrl="api/users/login",e.signupUrl="api/users/signup",e.facebook({clientId:"255060128209165",url:"/api/users/facebook"})}]),app.config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("home",{url:"/",templateUrl:"/html/home.html"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}).state("register",{url:"/register",templateUrl:"/html/register.html",controller:"registerCtrl"}).state("profile",{url:"/profile/:userId",templateUrl:"/html/profile.html",controller:"profileCtrl",resolve:{Profile:["User",function(e){return e.profile()}],ProfileByID:["User","$stateParams",function(e,o){return e.getProfile(o.userId)}]}}).state("users",{url:"/users",templateUrl:"/html/users.html",controller:"usersCtrl"}).state("business",{url:"/business",templateUrl:"/html/business.html",controller:"businessCtrl",resolve:{Profile:["User",function(e){return e.profile()}]}}).state("showBusiness",{url:"/business/:businessId",templateUrl:"html/showbusiness.html",controller:"showbusinessCtrl"}),o.otherwise("/")}]);var app=angular.module("myApp");app.controller("businessCtrl",["$scope","User","$rootScope","Business","Profile",function(e,o,s,n,t){console.log("businessCtrl"),e.businesses=[],console.log("Profile:",t);var r=t.favorites;e.searchBusiness=function(){console.log("$scope.newItem.searchParams",e.newItem.searchParams),n.searchYelp(e.newItem.searchParams).then(function(o){console.log("res from search businsess:",o);for(var s=0;s<r.length;s++)console.log(o.id," vs ",r[s]),o.id===r[s]&&(e.toggleFave=!0);e.businesses.push(o)})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.searchBusiness2=function(){console.log("search");var o={};e.newItem.location&&(o.location=e.newItem.location),e.newItem.term&&(o.term=e.newItem.term),console.log("searchBy:",o),n.searchCatagories(o).then(function(o){console.log("res from search businsess:",o.businesses),e.toggleFave=new Array(o.businesses.length);for(var s=0;s<o.businesses.length;s++)for(var n=0;n<r.length;n++)console.log(),o.businesses[s].id===r[n]?(console.log(o.businesses[s].id," vs ",r[n]),e.toggleFave[s]=1):e.toggleFave[s]=0;e.businesses=o.businesses})["catch"](function(e){console.log("err in businessCtrl: ",e)})},e.favorite=function(s){console.log("index: ",s),e.toggleFave[s]=!e.toggleFave[s],console.log("$scope.businesses[index].id",e.businesses[s].id),o.addFavoriteToUser(t._id,e.businesses[s].id).then(n.addFavorite(e.businesses[s],t._id)).then(function(e){console.log("res:",e)})["catch"](function(e){console.log("err in businessCtrl: ",e)}),console.log("$scope.businesses[index]:",e.businesses[s].id)},e.unFavorite=function(s){e.toggleFave[s]=!e.toggleFave[s],console.log("$scope.businesses[index].id",e.businesses[s].id),o.removeFavoritefromUser(t._id,e.businesses[s].id).then(function(e){console.log("res:",e)})["catch"](function(e){console.log("err in businessCtrl: ",e)}),console.log("$scope.businesses[index]:",e.businesses[s].id)}}]);var app=angular.module("myApp");app.controller("imageCtrl",["$scope","Upload","Profile","$rootScope",function(e,o,s,n){console.log("image ctrl"),n.currentUser=s,e.submit=function(){console.log("submit"),console.log("$scope.file:",e.file),o.upload({url:"/api/images",data:{photo:e.file,user:n.currentUser._id}}).then(function(o){console.log("res: ",o),e.savedImage=o.data})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("loginCtrl",["$scope","$state","$auth","$rootScope",function(e,o,s,n){console.log("loginCtrl!"),e.login=function(){s.login(e.user).then(function(e){console.log("res: ",e),o.go("profile")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("mainCtrl",["$scope","$state","$auth","$rootScope",function(e,o,s,n){console.log("mainCtrl!"),n.currentUser,e.isAuthenticated=function(){return s.isAuthenticated()},e.logout=function(){s.logout(),o.go("home")},e.authenticate=function(e){s.authenticate(e).then(function(e){o.go("home")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("profileCtrl",["$scope","Profile","ProfileByID","$state","User","$rootScope","WallPost",function(e,o,s,n,t,r,l){console.log("profileCtrl!"),r.currentUser=o,e.user=s||o,l.getWallPosts(e.user._id).then(function(o){e.userWallposts=o}),console.log("user:",e.user),console.log("curruser:",r.currentUser),e.showdisplayNameForm=function(){console.log("show form"),e.displayNameForm=!0},e.updatedisplayName=function(){e.displayNameForm=!1,e.user.displayName=e.newItem.displayName,t.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.displayName=""})["catch"](function(e){console.log("err:",e)})},e.canceldisplayName=function(){e.usernameForm=!0,e.newItem.displayName=""},e.showPictureForm=function(){console.log("show form"),e.photoForm=!0},e.updatePicture=function(){e.photoForm=!1,console.log("$state.current: ",n.current),e.user.profileImage=e.newItem.profileImage,console.log("$scope.newItem:",e.newItem),t.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.profileImage=""})["catch"](function(e){console.log("err:",e)})},e.cancelPhotoUrl=function(){e.photoForm=!0,e.newItem.photoUrl=""},e.deleteAccount=function(e){console.log(e._id),t.deleteAccount(e._id).then()["catch"](function(e){console.log("err: ",e)})},e.submitMessage=function(){var o={to:e.user,from:r.currentUser._id,fromName:r.currentUser.displayName,text:e.newItem.text,createdAt:"add moment"};console.log("post obj:",o),l.addWallPost(o).then(function(e){console.log("wallpost:",e),t.addWallPostToUser(s._id,e._id)}).then(n.go(n.$current,null,{reload:!0}))["catch"](function(e){console.log("err: ",e)})}}]);var app=angular.module("myApp");app.controller("registerCtrl",["$scope","$state","$auth",function(e,o,s){console.log("registerCtrl!"),e.register=function(){e.user.password!==e.user.password2?(e.user.password=null,e.user.password2=null,alert("Passwords must match!")):s.signup(e.user).then(function(e){console.log("res: ",e),o.go("login")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("showbusinessCtrl",["$scope","$stateParams","Business",function(e,o,s){console.log("showbusinessCtrl!");var n=o;console.log("businessId",n.businessId),s.searchYelp(n.businessId).then(function(o){console.log("res:",o),e.business=o;var s=o.location.coordinate.latitude,n=o.location.coordinate.longitude,t={"long":n,lat:s};console.log("cords:",t)})["catch"](function(e){console.log("err in businessCtrl: ",e)})}]);var app=angular.module("myApp");app.controller("usersCtrl",["$scope","$$state","$state","User",function(e,o,s,n){console.log("usersCtrl!");var t=n.getAll();console.log("userPromise:",t),t.then(function(o){console.log(o.data),e.userFeed=o.data})}]);var app=angular.module("myApp");app.service("Business",["$http","$q",function(e,o){this.getMap=function(s){return console.log("cords in service:",s),e.get("/api/businesses/map",s).then(function(e){return console.log("res.data in services:",e.data),console.log("res in services:",e),o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.searchYelp=function(s){return console.log("search: ",s),e.get("/api/businesses/yelp/"+s).then(function(e){return console.log("res.data in services:",e.data),console.log("res in services:",e),o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.searchCatagories=function(s){return console.log("inputs",s),e.post("/api/businesses/yelp/yelpCatagories",s).then(function(e){return console.log("res.data in services:",e.data),console.log("res in services:",e),o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.addFavorite=function(s,n){return console.log("businessObj:",s),e.post("/api/businesses/"+n,s).then(function(e){return console.log("res ln 24 business services:",e),o.resolve(e)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("image",["$http","$q",function(e,o){this.getAll=function(){return e.get("/api/cruds")},this.getById=function(o){return e.get("/api/cruds/"+o)},this.addCrud=function(s){return e.post("/api/cruds",s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.deleteCrud=function(s){return e["delete"]("/api/cruds/"+s).then(function(){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.updateCrud=function(s,n){return e.put("/api/cruds/"+s,n).then(function(e){return o.resolve(n)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("User",["$http","$q",function(e,o){this.profile=function(){return e.get("/api/users/profile").then(function(e){return o.resolve(e.data)})},this.getProfile=function(s){return e.get("/api/users/profile/"+s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getAll=function(){return e.get("/api/users")},this.updateProfile=function(s,n){return console.log("here"),console.log(s," ",n),e.put("/api/users/profile/"+s,n).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.deleteAccount=function(s){return e["delete"]("/api/users/profile/"+s).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.addFavoriteToUser=function(s,n){return e.put("/api/users/profile/"+s+"/add/"+n).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.removeFavoritefromUser=function(s,n){return console.log("remove Favorite","id:",s,"yelpId",n),e.put("/api/users/profile/"+s+"/remove/"+n).then(function(e){return console.log("res ln 53:",e),o.resolve()})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("WallPost",["$http","$q",function(e,o){this.addWallPost=function(s){return console.log("in add wallpost: ",s),e.post("/api/wallposts",s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getWallPosts=function(s){return e.get("/api/wallposts/"+s).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err: ",e)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2J1c2luZXNzQ3RybC5qcyIsImNvbnRyb2xsZXJzL2ltYWdlQ3RybC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL21haW5DdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUN0cmwuanMiLCJjb250cm9sbGVycy9yZWdpc3RlckN0cmwuanMiLCJjb250cm9sbGVycy9zaG93YnVzaW5lc3NDdHJsLmpzIiwiY29udHJvbGxlcnMvdXNlcnNDdHJsLmpzIiwic2VydmljZXMvYnVzaW5lc3NzZXJ2aWNlcy5qcyIsInNlcnZpY2VzL2ltYWdlc2VydmljZXMuanMiLCJzZXJ2aWNlcy91c2Vyc2VydmljZXMuanMiLCJzZXJ2aWNlcy93YWxscG9zdHNlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkYXV0aFByb3ZpZGVyIiwibG9naW5VcmwiLCJzaWdudXBVcmwiLCJmYWNlYm9vayIsImNsaWVudElkIiwidXJsIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInJlc29sdmUiLCJQcm9maWxlIiwiVXNlciIsInByb2ZpbGUiLCJQcm9maWxlQnlJRCIsIiRzdGF0ZVBhcmFtcyIsImdldFByb2ZpbGUiLCJ1c2VySWQiLCJvdGhlcndpc2UiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiQnVzaW5lc3MiLCJjb25zb2xlIiwibG9nIiwiYnVzaW5lc3NlcyIsImZhdm9yaXRlcyIsInNlYXJjaEJ1c2luZXNzIiwibmV3SXRlbSIsInNlYXJjaFBhcmFtcyIsInNlYXJjaFllbHAiLCJ0aGVuIiwicmVzIiwiaSIsImxlbmd0aCIsImlkIiwidG9nZ2xlRmF2ZSIsInB1c2giLCJlcnIiLCJzZWFyY2hCdXNpbmVzczIiLCJzZWFyY2hCeSIsImxvY2F0aW9uIiwidGVybSIsInNlYXJjaENhdGFnb3JpZXMiLCJBcnJheSIsImsiLCJmYXZvcml0ZSIsImluZGV4IiwiYWRkRmF2b3JpdGVUb1VzZXIiLCJfaWQiLCJhZGRGYXZvcml0ZSIsInVuRmF2b3JpdGUiLCJyZW1vdmVGYXZvcml0ZWZyb21Vc2VyIiwiVXBsb2FkIiwiY3VycmVudFVzZXIiLCJzdWJtaXQiLCJmaWxlIiwidXBsb2FkIiwiZGF0YSIsInBob3RvIiwidXNlciIsInNhdmVkSW1hZ2UiLCIkc3RhdGUiLCIkYXV0aCIsImxvZ2luIiwiZ28iLCJpc0F1dGhlbnRpY2F0ZWQiLCJsb2dvdXQiLCJhdXRoZW50aWNhdGUiLCJwcm92aWRlciIsIldhbGxQb3N0IiwiZ2V0V2FsbFBvc3RzIiwidXNlcldhbGxwb3N0cyIsInNob3dkaXNwbGF5TmFtZUZvcm0iLCJkaXNwbGF5TmFtZUZvcm0iLCJ1cGRhdGVkaXNwbGF5TmFtZSIsImRpc3BsYXlOYW1lIiwidXBkYXRlUHJvZmlsZSIsImNhbmNlbGRpc3BsYXlOYW1lIiwidXNlcm5hbWVGb3JtIiwic2hvd1BpY3R1cmVGb3JtIiwicGhvdG9Gb3JtIiwidXBkYXRlUGljdHVyZSIsImN1cnJlbnQiLCJwcm9maWxlSW1hZ2UiLCJjYW5jZWxQaG90b1VybCIsInBob3RvVXJsIiwiZGVsZXRlQWNjb3VudCIsInN1Ym1pdE1lc3NhZ2UiLCJwb3N0T2JqIiwidG8iLCJmcm9tIiwiZnJvbU5hbWUiLCJ0ZXh0IiwiY3JlYXRlZEF0IiwiYWRkV2FsbFBvc3QiLCJ3YWxscG9zdCIsImFkZFdhbGxQb3N0VG9Vc2VyIiwiJGN1cnJlbnQiLCJyZWxvYWQiLCJyZWdpc3RlciIsInBhc3N3b3JkIiwicGFzc3dvcmQyIiwiYWxlcnQiLCJzaWdudXAiLCJidXNpbmVzc0lkIiwiYnVzaW5lc3MiLCJsYXQiLCJjb29yZGluYXRlIiwibGF0aXR1ZGUiLCJsb25nIiwibG9uZ2l0dWRlIiwiY29yZHMiLCIkJHN0YXRlIiwidXNlclByb21pc2UiLCJnZXRBbGwiLCJyZXN1bHQiLCJ1c2VyRmVlZCIsInNlcnZpY2UiLCIkaHR0cCIsIiRxIiwidGhpcyIsImdldE1hcCIsImdldCIsInNlYXJjaCIsImlucHV0cyIsInBvc3QiLCJidXNpbmVzc09iaiIsImdldEJ5SWQiLCJhZGRDcnVkIiwiY3J1ZCIsImRlbGV0ZUNydWQiLCJ1cGRhdGVDcnVkIiwicHV0IiwicHJvZmlsZU9iaiIsInllbHBJZCJdLCJtYXBwaW5ncyI6IkFBQUEsWUFFQSxJQUFJQSxLQUFNQyxRQUFRQyxPQUFPLFNBQVUsWUFBYSxhQUFjLGdCQUU5REYsS0FBSUcsUUFBQSxnQkFBTyxTQUFTQyxHQUVsQkEsRUFBY0MsU0FBVyxrQkFDekJELEVBQWNFLFVBQVksbUJBRTFCRixFQUFjRyxVQUNaQyxTQUFVLGtCQUNWQyxJQUFLLDJCQUtUVCxJQUFJRyxRQUFBLGlCQUFBLHFCQUFPLFNBQVNPLEVBQWdCQyxHQUVsQ0QsRUFDR0UsTUFBTSxRQUFVSCxJQUFLLElBQUtJLFlBQWEsb0JBQ3ZDRCxNQUFNLFNBQ0xILElBQUssU0FDTEksWUFBYSxtQkFDYkMsV0FBWSxjQUViRixNQUFNLFlBQ0xILElBQUssWUFDTEksWUFBYSxzQkFDYkMsV0FBWSxpQkFFYkYsTUFBTSxXQUNMSCxJQUFLLG1CQUNMSSxZQUFhLHFCQUNiQyxXQUFZLGNBQ1pDLFNBQ0VDLFNBQUEsT0FBUyxTQUFTQyxHQUNoQixNQUFPQSxHQUFLQyxZQUVkQyxhQUFBLE9BQUEsZUFBYSxTQUFTRixFQUFNRyxHQUMxQixNQUFPSCxHQUFLSSxXQUFXRCxFQUFhRSxhQUl6Q1YsTUFBTSxTQUNMSCxJQUFLLFNBQ0xJLFlBQWEsbUJBQ2JDLFdBQVksY0FFYkYsTUFBTSxZQUNMSCxJQUFLLFlBQ0xJLFlBQWEsc0JBQ2JDLFdBQVksZUFDWkMsU0FDRUMsU0FBQSxPQUFTLFNBQVNDLEdBQ2hCLE1BQU9BLEdBQUtDLGVBSWpCTixNQUFNLGdCQUNMSCxJQUFLLHdCQUNMSSxZQUFhLHlCQUNiQyxXQUFZLHFCQUdoQkgsRUFBbUJZLFVBQVUsT0M5RC9CLElBQUl2QixLQUFNQyxRQUFRQyxPQUFPLFFBRXpCRixL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RyxLQUFLLFNBQUFDLEdBRUgsTUFEQVQsU0FBUUMsSUFBSSxhQUFjUSxHQUNuQndGLEVBQUc3RyxZQUhQNEcsU0FLQSxTQUFBakYsR0FDTGYsUUFBUUMsSUFBSSxPQUFRYyxRQ25FMUIsSUFBSTFDLEtBQU1DLFFBQVFDLE9BQU8sUUFFekJGLEtBQUkwSCxRQUFRLFlBQUEsUUFBQSxLQUFZLFNBQVNDLEVBQU9DLEdBRXBDQyxLQUFLMUIsWUFBYSxTQUFDQyxHQUVuQixNQURBekUsU0FBUUMsSUFBSSxvQkFBcUJ3RSxHQUMxQnVCLEVBQU1PLEtBQU4saUJBQTZCOUIsR0FDakNqRSxLQUFLLFNBQUFDLEdBQ0osTUFBT3dGLEdBQUc3RyxRQUFRcUIsRUFBSTBCLFFBRm5CNkQsU0FJRSxTQUFBakYsR0FDTGYsUUFBUUMsSUFBSSxPQUFRYyxNQUt4Qm1GLEtBQUtsRCxhQUFlLFNBQUNyRCxHQUNyQixNQUFPcUcsR0FBTUksSUFBTixrQkFBNEJ6RyxHQUNoQ2EsS0FBSyxTQUFBQyxHQUNKLE1BQU93RixHQUFHN0csUUFBUXFCLEVBQUkwQixRQUZuQjZELFNBSUUsU0FBQWpGLEdBQ0xmLFFBQVFDLElBQUksUUFBU2MiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJywgWyd1aS5yb3V0ZXInLCAnc2F0ZWxsaXplcicsICduZ0ZpbGVVcGxvYWQnXSk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24oJGF1dGhQcm92aWRlcikge1xuXG4gICRhdXRoUHJvdmlkZXIubG9naW5VcmwgPSAnYXBpL3VzZXJzL2xvZ2luJztcbiAgJGF1dGhQcm92aWRlci5zaWdudXBVcmwgPSAnYXBpL3VzZXJzL3NpZ251cCc7XG5cbiAgJGF1dGhQcm92aWRlci5mYWNlYm9vayh7XG4gICAgY2xpZW50SWQ6ICcyNTUwNjAxMjgyMDkxNjUnLFxuICAgIHVybDogJy9hcGkvdXNlcnMvZmFjZWJvb2snXG4gIH0pO1xuXG59KTtcblxuYXBwLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgJHN0YXRlUHJvdmlkZXJcbiAgICAuc3RhdGUoJ2hvbWUnLCB7IHVybDogJy8nLCB0ZW1wbGF0ZVVybDogJy9odG1sL2hvbWUuaHRtbCcgfSlcbiAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvbG9naW4uaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsJ1xuICAgIH0pXG4gICAgLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3JlZ2lzdGVyLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ3JlZ2lzdGVyQ3RybCdcbiAgICB9KVxuICAgIC5zdGF0ZSgncHJvZmlsZScsIHtcbiAgICAgIHVybDogJy9wcm9maWxlLzp1c2VySWQnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9wcm9maWxlLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ3Byb2ZpbGVDdHJsJyxcbiAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgUHJvZmlsZTogZnVuY3Rpb24oVXNlcikge1xuICAgICAgICAgIHJldHVybiBVc2VyLnByb2ZpbGUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgUHJvZmlsZUJ5SUQ6IGZ1bmN0aW9uKFVzZXIsICRzdGF0ZVBhcmFtcyl7XG4gICAgICAgICAgcmV0dXJuIFVzZXIuZ2V0UHJvZmlsZSgkc3RhdGVQYXJhbXMudXNlcklkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgLnN0YXRlKCd1c2VycycsIHtcbiAgICAgIHVybDogJy91c2VycycsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3VzZXJzLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ3VzZXJzQ3RybCdcbiAgICB9KVxuICAgIC5zdGF0ZSgnYnVzaW5lc3MnLCB7XG4gICAgICB1cmw6ICcvYnVzaW5lc3MnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9idXNpbmVzcy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdidXNpbmVzc0N0cmwnLFxuICAgICAgcmVzb2x2ZToge1xuICAgICAgICBQcm9maWxlOiBmdW5jdGlvbihVc2VyKSB7XG4gICAgICAgICAgcmV0dXJuIFVzZXIucHJvZmlsZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgICAuc3RhdGUoJ3Nob3dCdXNpbmVzcycsIHtcbiAgICAgIHVybDogJy9idXNpbmVzcy86YnVzaW5lc3NJZCcsIFxuICAgICAgdGVtcGxhdGVVcmw6ICdodG1sL3Nob3didXNpbmVzcy5odG1sJywgXG4gICAgICBjb250cm9sbGVyOiAnc2hvd2J1c2luZXNzQ3RybCdcbiAgICAgIH0pXG4gICAgXG4gICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pO1xuXG4iLCIndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2J1c2luZXNzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgVXNlciwgJHJvb3RTY29wZSwgQnVzaW5lc3MsIFByb2ZpbGUpe1xuICBjb25zb2xlLmxvZyhcImJ1c2luZXNzQ3RybFwiKTtcblxuICAkc2NvcGUuYnVzaW5lc3NlcyA9IFtdO1xuICBjb25zb2xlLmxvZyhcIlByb2ZpbGU6XCIsIFByb2ZpbGUpXG4gIHZhciBmYXZvcml0ZXMgPSBQcm9maWxlLmZhdm9yaXRlcztcblxuICAkc2NvcGUuc2VhcmNoQnVzaW5lc3MgPSAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5uZXdJdGVtLnNlYXJjaFBhcmFtc1wiICwgJHNjb3BlLm5ld0l0ZW0uc2VhcmNoUGFyYW1zKVxuICAgICAgQnVzaW5lc3Muc2VhcmNoWWVscCgkc2NvcGUubmV3SXRlbS5zZWFyY2hQYXJhbXMpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzIGZyb20gc2VhcmNoIGJ1c2luc2VzczpcIiAsIHJlcyk7XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPCBmYXZvcml0ZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5pZCAsXCIgdnMgXCIsIGZhdm9yaXRlc1tpXSk7XG4gICAgICAgICAgaWYocmVzLmlkID09PSBmYXZvcml0ZXNbaV0pe1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUZhdmUgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuYnVzaW5lc3Nlcy5wdXNoKHJlcyk7XG4gICAgICB9KSAgICBcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KVxuICAgIH1cblxuICAkc2NvcGUuc2VhcmNoQnVzaW5lc3MyID0gKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJzZWFyY2hcIik7XG4gICAgICB2YXIgc2VhcmNoQnkgPSB7fTtcblxuXG4gICAgICBpZigkc2NvcGUubmV3SXRlbS5sb2NhdGlvbil7XG4gICAgICAgIHNlYXJjaEJ5LmxvY2F0aW9uID0gJHNjb3BlLm5ld0l0ZW0ubG9jYXRpb25cbiAgICAgIH1cbiAgICAgIGlmKCRzY29wZS5uZXdJdGVtLnRlcm0pe1xuICAgICAgICBzZWFyY2hCeS50ZXJtID0gJHNjb3BlLm5ld0l0ZW0udGVybTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKFwic2VhcmNoQnk6XCIsIHNlYXJjaEJ5KTtcblxuICAgICAgQnVzaW5lc3Muc2VhcmNoQ2F0YWdvcmllcyhzZWFyY2hCeSlcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXMgZnJvbSBzZWFyY2ggYnVzaW5zZXNzOlwiICwgcmVzLmJ1c2luZXNzZXMpO1xuICAgICAgICAkc2NvcGUudG9nZ2xlRmF2ZSA9IG5ldyBBcnJheShyZXMuYnVzaW5lc3Nlcy5sZW5ndGgpXG5cbiAgICAgICAgLy9jaGVjayBmb3IgZmF2b3JpdGVzXG4gICAgICAgIGZvcih2YXIgaz0wOyBrPHJlcy5idXNpbmVzc2VzLmxlbmd0aDsgaysrKXtcbiAgICAgICAgICBmb3IodmFyIGk9MDsgaTwgZmF2b3JpdGVzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKClcbiAgICAgICAgICAgIGlmKHJlcy5idXNpbmVzc2VzW2tdLmlkID09PSBmYXZvcml0ZXNbaV0pe1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuYnVzaW5lc3Nlc1trXS5pZCwgXCIgdnMgXCIsIGZhdm9yaXRlc1tpXSk7XG4gICAgICAgICAgICAgICRzY29wZS50b2dnbGVGYXZlW2tdID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgJHNjb3BlLnRvZ2dsZUZhdmVba10gPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuYnVzaW5lc3NlcyA9IHJlcy5idXNpbmVzc2VzO1xuXG4gICAgICB9KSAgICBcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gICAgICB9KVxuICAgIH1cblxuXG4gICAgLy9hZGQgdG8gdXNlciBmYXZvcml0ZXNcbiAgICAkc2NvcGUuZmF2b3JpdGUgPSAoaW5kZXgpPT57XG4gICAgICBjb25zb2xlLmxvZyhcImluZGV4OiBcIiwgaW5kZXgpO1xuXG4gICAgICAkc2NvcGUudG9nZ2xlRmF2ZVtpbmRleF0gPSAhJHNjb3BlLnRvZ2dsZUZhdmVbaW5kZXhdO1xuICAgICAgY29uc29sZS5sb2coXCIkc2NvcGUuYnVzaW5lc3Nlc1tpbmRleF0uaWRcIiwgJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkKVxuICAgICAgVXNlci5hZGRGYXZvcml0ZVRvVXNlciggUHJvZmlsZS5faWQsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZClcbiAgICAgIC50aGVuKEJ1c2luZXNzLmFkZEZhdm9yaXRlKCRzY29wZS5idXNpbmVzc2VzW2luZGV4XSwgUHJvZmlsZS5faWQpKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlczpcIiAsIHJlcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnIgaW4gYnVzaW5lc3NDdHJsOiBcIiwgZXJyKTtcbiAgICAgIH0pICAgIFxuICAgICAgY29uc29sZS5sb2coXCIkc2NvcGUuYnVzaW5lc3Nlc1tpbmRleF06XCIsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZCk7XG4gICAgICAvKiAgICAgXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkqL1xuICAgIH1cblxuICAgICRzY29wZS51bkZhdm9yaXRlID0gKGluZGV4KT0+e1xuICAgICAgJHNjb3BlLnRvZ2dsZUZhdmVbaW5kZXhdID0gISRzY29wZS50b2dnbGVGYXZlW2luZGV4XTtcbiAgICAgIGNvbnNvbGUubG9nKFwiJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkXCIsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZClcbiAgICAgIFVzZXIucmVtb3ZlRmF2b3JpdGVmcm9tVXNlciggUHJvZmlsZS5faWQsICRzY29wZS5idXNpbmVzc2VzW2luZGV4XS5pZClcbiAgICAgIC8vLnRoZW4oQnVzaW5lc3MucmVtb3ZlRmF2b3JpdGUoJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLCBQcm9maWxlLl9pZCkpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVyciBpbiBidXNpbmVzc0N0cmw6IFwiLCBlcnIpO1xuICAgICAgfSkgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5idXNpbmVzc2VzW2luZGV4XTpcIiwgJHNjb3BlLmJ1c2luZXNzZXNbaW5kZXhdLmlkKTtcbiAgICB9XG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignaW1hZ2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVcGxvYWQsIFByb2ZpbGUsICRyb290U2NvcGUpIHtcbiAgY29uc29sZS5sb2coXCJpbWFnZSBjdHJsXCIpO1xuXG5cbiAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IFByb2ZpbGU7XG5cbiAgJHNjb3BlLnN1Ym1pdCA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKCdzdWJtaXQnKTtcbiAgICBjb25zb2xlLmxvZygnJHNjb3BlLmZpbGU6JywgJHNjb3BlLmZpbGUpO1xuICAgIFxuICAgIFVwbG9hZC51cGxvYWQoe1xuICAgICAgdXJsOiAnL2FwaS9pbWFnZXMnLFxuICAgICAgZGF0YToge3Bob3RvOiAkc2NvcGUuZmlsZSwgdXNlcjogJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWR9IC8vYW55dGhpbmcgZWxzZSBsaWtlIG5hbWUgd2lsbCBlbmQgdXAgaW4gcmVxLmJvZHlcbiAgICB9KVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAgIGNvbnNvbGUubG9nKCdyZXM6ICcsIHJlcyk7XG4gICAgICAkc2NvcGUuc2F2ZWRJbWFnZSA9IHJlcy5kYXRhO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpXG4gICAgfSlcbiAgfTtcblxufSk7XG5cbiAgLyokc2NvcGUuY3J1ZHMgPSBbXTtcblxuICBDcnVkLmdldEFsbCgpXG4gIC50aGVuKHJlcyA9PntcbiAgICAkc2NvcGUuY3J1ZHMgPSByZXMuZGF0YTtcbiAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5jcnVkczpcIiwgJHNjb3BlLmNydWRzKTtcbiAgfSlcbiAgLmNhdGNoKGVyciA9PntcbiAgICBjb25zb2xlLmxvZyhcImVycjogXCIsIGVycik7XG4gIH0pXG5cbiAgJHNjb3BlLmFkZENydWQgPSAoKSA9PntcbiAgICBDcnVkLmFkZENydWQoJHNjb3BlLm5ld0l0ZW0pXG4gICAgLnRoZW4oY3J1ZCA9PntcbiAgICAgICRzY29wZS5jcnVkcy5wdXNoKGNydWQpO1xuICAgICAgJHNjb3BlLm5ld0l0ZW0gPSB7fTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnI9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3I6IFwiLCBlcnIgKTtcbiAgICB9KTtcbiAgfVxuXG5cbiAgJHNjb3BlLmRlbGV0ZUNydWQgPSAoaW5kLCBjcnVkKSA9PntcbiAgICBjb25zb2xlLmxvZyhcImNydWQ6XCIsIGNydWQpXG4gICAgQ3J1ZC5kZWxldGVDcnVkKGNydWQuX2lkKVxuICAgIC50aGVuKGNydWQgPT4ge1xuICAgICAgJHNjb3BlLmNydWRzLnNwbGljZShpbmQsMSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycm9yOiBcIiwgZXJyICk7XG4gICAgfSk7XG4gIH1cblxuICAkc2NvcGUuc2hvd1VwZGF0ZUZvcm0gPSAoaW5kZXgsIGNydWQpID0+e1xuICAgIGNvbnNvbGUubG9nKFwiaW5kZXg6IFwiLCBpbmRleCk7XG4gICAgY29uc29sZS5sb2coXCJjcnVkOiBcIiwgY3J1ZCk7XG4gICAgJHNjb3BlLnNob3dVcGRhdGUgPXRydWU7XG4gICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBjcnVkO1xuICAgICRzY29wZS51cGRhdGVJbmRleCA9IGluZGV4O1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZUNydWQ9ICgpID0+e1xuICAgICRzY29wZS5zaG93VXBkYXRlID1mYWxzZTtcbiAgICBDcnVkLnVwZGF0ZUNydWQoJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCAkc2NvcGUudXBkYXRlSXRlbSlcbiAgICAudGhlbihjcnVkID0+e1xuICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGUgYXB0OlwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCBcIiAsIFwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycj0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnJvcjogXCIsIGVyciApO1xuICAgIH0pO1xuICB9XG4qL1xuXG4iLCJcbid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRhdXRoLCAkcm9vdFNjb3BlKSB7XG4gIGNvbnNvbGUubG9nKCdsb2dpbkN0cmwhJyk7XG5cbiAgJHNjb3BlLmxvZ2luID0gKCkgPT4ge1xuICAgICAgJGF1dGgubG9naW4oJHNjb3BlLnVzZXIpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOiBcIiwgcmVzKTtcbiAgICAgICAgLy8kcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLmRhdGE7XG4gICAgICAgICRzdGF0ZS5nbygncHJvZmlsZScpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdtYWluQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkYXV0aCwgJHJvb3RTY29wZSkge1xuICBjb25zb2xlLmxvZygnbWFpbkN0cmwhJyk7XG5cbiAgJHJvb3RTY29wZS5jdXJyZW50VXNlcjtcblxuICAkc2NvcGUuaXNBdXRoZW50aWNhdGVkID0gKCkgPT4gJGF1dGguaXNBdXRoZW50aWNhdGVkKCk7XG5cbiAgJHNjb3BlLmxvZ291dCA9ICgpID0+IHtcbiAgICAkYXV0aC5sb2dvdXQoKTtcbiAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgfTtcblxuICAkc2NvcGUuYXV0aGVudGljYXRlID0gcHJvdmlkZXIgPT4ge1xuICAgICRhdXRoLmF1dGhlbnRpY2F0ZShwcm92aWRlcilcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICB9O1xufSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3Byb2ZpbGVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBQcm9maWxlLCBQcm9maWxlQnlJRCwgJHN0YXRlLCBVc2VyLCAkcm9vdFNjb3BlLCBXYWxsUG9zdCkge1xuICBcbiAgY29uc29sZS5sb2coJ3Byb2ZpbGVDdHJsIScpO1xuXG4gICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBQcm9maWxlO1xuXG4gICRzY29wZS51c2VyID0gUHJvZmlsZUJ5SUQgfHwgUHJvZmlsZTtcblxuICBXYWxsUG9zdC5nZXRXYWxsUG9zdHMoJHNjb3BlLnVzZXIuX2lkKVxuICAgIC50aGVuKHJlcyA9PntcbiAgICAkc2NvcGUudXNlcldhbGxwb3N0cyA9IHJlcztcbiAgfSlcblxuICBjb25zb2xlLmxvZyhcInVzZXI6XCIsICRzY29wZS51c2VyICk7XG4gIGNvbnNvbGUubG9nKFwiY3VycnVzZXI6XCIsICRyb290U2NvcGUuY3VycmVudFVzZXIgKTtcblxuICAkc2NvcGUuc2hvd2Rpc3BsYXlOYW1lRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZWRpc3BsYXlOYW1lID0gKCkgPT4ge1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSBmYWxzZTtcbiAgICAkc2NvcGUudXNlci5kaXNwbGF5TmFtZSA9ICRzY29wZS5uZXdJdGVtLmRpc3BsYXlOYW1lO1xuICAgIFVzZXIudXBkYXRlUHJvZmlsZSgkc2NvcGUudXNlci5faWQsICRzY29wZS5uZXdJdGVtKVxuICAgICAgLnRoZW4ocHJvZmlsZSA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJwcm9maWxlOlwiLCBwcm9maWxlKTtcbiAgICAgICAgJHNjb3BlLm5ld0l0ZW0uZGlzcGxheU5hbWUgPSAnJztcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICAkc2NvcGUuY2FuY2VsZGlzcGxheU5hbWUgPSAoKSA9PntcbiAgICAkc2NvcGUudXNlcm5hbWVGb3JtID0gdHJ1ZTtcbiAgICAkc2NvcGUubmV3SXRlbS5kaXNwbGF5TmFtZSA9ICcnO1xuICB9XG5cbi8vcGhvdG9cbiAgJHNjb3BlLnNob3dQaWN0dXJlRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZVBpY3R1cmUgPSAoKSA9PiB7XG4gICAgJHNjb3BlLnBob3RvRm9ybSA9IGZhbHNlO1xuICAgIGNvbnNvbGUubG9nKFwiJHN0YXRlLmN1cnJlbnQ6IFwiLCAkc3RhdGUuY3VycmVudCk7XG4gICAgJHNjb3BlLnVzZXIucHJvZmlsZUltYWdlID0gJHNjb3BlLm5ld0l0ZW0ucHJvZmlsZUltYWdlO1xuICAgIGNvbnNvbGUubG9nKFwiJHNjb3BlLm5ld0l0ZW06XCIsICRzY29wZS5uZXdJdGVtKTtcbiAgICBVc2VyLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLnVzZXIuX2lkLCAkc2NvcGUubmV3SXRlbSlcbiAgICAgIC50aGVuKHByb2ZpbGUgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZTpcIiwgcHJvZmlsZSk7XG4gICAgICAgICRzY29wZS5uZXdJdGVtLnByb2ZpbGVJbWFnZSA9ICcnO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgfVxuXG4gICRzY29wZS5jYW5jZWxQaG90b1VybCA9ICgpID0+e1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICAgICRzY29wZS5uZXdJdGVtLnBob3RvVXJsID0gJyc7XG4gIH1cblxuXG4gICRzY29wZS5kZWxldGVBY2NvdW50ID0gKHVzZXIpID0+e1xuICAgIC8vYWRkIHN3YWxcbiAgICBjb25zb2xlLmxvZyh1c2VyLl9pZCk7XG4gICAgVXNlci5kZWxldGVBY2NvdW50KHVzZXIuX2lkKVxuICAgICAgLnRoZW4oKVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6IFwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICAgICRzY29wZS5zdWJtaXRNZXNzYWdlID0gKCkgPT57XG5cbiAgICB2YXIgcG9zdE9iaiA9IHtcbiAgICAgIHRvOiAkc2NvcGUudXNlcixcbiAgICAgIGZyb206ICRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkLFxuICAgICAgZnJvbU5hbWU6ICRyb290U2NvcGUuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXG4gICAgICB0ZXh0OiAkc2NvcGUubmV3SXRlbS50ZXh0LFxuICAgICAgY3JlYXRlZEF0OiBcImFkZCBtb21lbnRcIlxuICAgIH07XG5cbiAgICBjb25zb2xlLmxvZyhcInBvc3Qgb2JqOlwiLCBwb3N0T2JqKTtcblxuXG4gICAgV2FsbFBvc3QuYWRkV2FsbFBvc3QocG9zdE9iailcbiAgICAgIC50aGVuKHdhbGxwb3N0ID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcIndhbGxwb3N0OlwiICwgd2FsbHBvc3QpO1xuICAgICAgICBVc2VyLmFkZFdhbGxQb3N0VG9Vc2VyKFByb2ZpbGVCeUlELl9pZCwgd2FsbHBvc3QuX2lkKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigkc3RhdGUuZ28oJHN0YXRlLiRjdXJyZW50LCBudWxsLCB7IHJlbG9hZDogdHJ1ZSB9KSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOiBcIiwgZXJyKTtcbiAgICAgIH0pXG4gICB9O1xuXG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRhdXRoKSB7XG4gIGNvbnNvbGUubG9nKCdyZWdpc3RlckN0cmwhJyk7XG5cbiAgJHNjb3BlLnJlZ2lzdGVyID0gKCkgPT4ge1xuICAgIGlmKCRzY29wZS51c2VyLnBhc3N3b3JkICE9PSAkc2NvcGUudXNlci5wYXNzd29yZDIpe1xuICAgICAgJHNjb3BlLnVzZXIucGFzc3dvcmQgPSBudWxsO1xuICAgICAgJHNjb3BlLnVzZXIucGFzc3dvcmQyID0gbnVsbDtcbiAgICAgIGFsZXJ0KCdQYXNzd29yZHMgbXVzdCBtYXRjaCEnKTtcbiAgICB9ZWxzZXtcbiAgICAgICRhdXRoLnNpZ251cCgkc2NvcGUudXNlcilcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXM6IFwiLCByZXMpO1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICB9KVxuICAgIH1cbiAgfTtcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5cbmFwcC5jb250cm9sbGVyKCdzaG93YnVzaW5lc3NDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGVQYXJhbXMsIEJ1c2luZXNzKSB7XG4gIGNvbnNvbGUubG9nKCdzaG93YnVzaW5lc3NDdHJsIScpO1xuXG4gIGxldCBidXNpbmVzc0lkID0gJHN0YXRlUGFyYW1zO1xuICBjb25zb2xlLmxvZyhcImJ1c2luZXNzSWRcIiwgYnVzaW5lc3NJZC5idXNpbmVzc0lkKTtcblxuICBCdXNpbmVzcy5zZWFyY2hZZWxwKGJ1c2luZXNzSWQuYnVzaW5lc3NJZClcbiAgLnRoZW4ocmVzID0+e1xuICAgIGNvbnNvbGUubG9nKFwicmVzOlwiICwgcmVzKTtcbiAgICAkc2NvcGUuYnVzaW5lc3MgPSByZXM7XG4gICAgdmFyIGxhdCA9IHJlcy5sb2NhdGlvbi5jb29yZGluYXRlLmxhdGl0dWRlO1xuICAgIHZhciBsb25nID0gcmVzLmxvY2F0aW9uLmNvb3JkaW5hdGUubG9uZ2l0dWRlO1xuICAgIHZhciBjb3JkcyA9IHtcbiAgICAgIGxvbmc6IGxvbmcsXG4gICAgICBsYXQ6IGxhdFxuICAgIH1cbiAgICBjb25zb2xlLmxvZygnY29yZHM6JywgY29yZHMpO1xuICAgIC8vQnVzaW5lc3MuZ2V0TWFwKGNvcmRzKVxuICB9KSAgIFxuICAuY2F0Y2goZXJyID0+e1xuICAgIGNvbnNvbGUubG9nKFwiZXJyIGluIGJ1c2luZXNzQ3RybDogXCIsIGVycik7XG4gIH0pXG5cbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCd1c2Vyc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICQkc3RhdGUsICRzdGF0ZSwgVXNlcikge1xuICBjb25zb2xlLmxvZygndXNlcnNDdHJsIScpO1xuXG4gIHZhciB1c2VyUHJvbWlzZSA9IFVzZXIuZ2V0QWxsKCk7XG4gIGNvbnNvbGUubG9nKFwidXNlclByb21pc2U6XCIsIHVzZXJQcm9taXNlKTtcbiAgdXNlclByb21pc2UudGhlbihcbiAgICBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQuZGF0YSk7XG4gICAgICAgJHNjb3BlLnVzZXJGZWVkID0gcmVzdWx0LmRhdGE7XG4gICAgfSk7XG59KTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLnNlcnZpY2UoJ0J1c2luZXNzJywgZnVuY3Rpb24oJGh0dHAsICRxKXtcblxuICB0aGlzLmdldE1hcCA9IChjb3JkcykgPT57XG4gICAgY29uc29sZS5sb2coXCJjb3JkcyBpbiBzZXJ2aWNlOlwiICwgY29yZHMpO1xuICAgIHJldHVybiAkaHR0cC5nZXQoYC9hcGkvYnVzaW5lc3Nlcy9tYXBgLCBjb3JkcylcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlcy5kYXRhIGluIHNlcnZpY2VzOlwiLCByZXMuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzIGluIHNlcnZpY2VzOlwiLCByZXMpO1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgIH0pXG4gIH1cblxuICB0aGlzLnNlYXJjaFllbHAgPSAoc2VhcmNoKSA9PntcbiAgICBjb25zb2xlLmxvZyhcInNlYXJjaDogXCIsIHNlYXJjaCk7XG4gICAgcmV0dXJuICRodHRwLmdldChgL2FwaS9idXNpbmVzc2VzL3llbHAvJHtzZWFyY2h9YClcbiAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXMuZGF0YSBpbiBzZXJ2aWNlczpcIiwgcmVzLmRhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlcyBpbiBzZXJ2aWNlczpcIiwgcmVzKTtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUocmVzLmRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICB9XG5cbiAgdGhpcy5zZWFyY2hDYXRhZ29yaWVzID0gKGlucHV0cykgPT57XG4gICAgY29uc29sZS5sb2coXCJpbnB1dHNcIiwgaW5wdXRzKTtcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS9idXNpbmVzc2VzL3llbHAveWVscENhdGFnb3JpZXNgLCBpbnB1dHMpXG4gICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzLmRhdGEgaW4gc2VydmljZXM6XCIsIHJlcy5kYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXMgaW4gc2VydmljZXM6XCIsIHJlcyk7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgfVxuXG4gIHRoaXMuYWRkRmF2b3JpdGUgPSAoYnVzaW5lc3NPYmosIHVzZXJJZCkgPT57XG4gICAgY29uc29sZS5sb2coXCJidXNpbmVzc09iajpcIiwgYnVzaW5lc3NPYmopO1xuICAgIHJldHVybiAkaHR0cC5wb3N0KGAvYXBpL2J1c2luZXNzZXMvJHt1c2VySWR9YCwgYnVzaW5lc3NPYmopXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXMgbG4gMjQgYnVzaW5lc3Mgc2VydmljZXM6XCIsIHJlcyk7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcbn0pO1xuXG4vL2RvIGZpbmQsIGlmIG5vdCBpbiBkYiB0aGVuIGFkZCwgaWYgaW4gZGIgYWRkIHVzZXIgdG8gZmF2b3JpdGVkIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdpbWFnZScsIGZ1bmN0aW9uKCRodHRwLCAkcSl7XG5cbiAgdGhpcy5nZXRBbGwgPSAoKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NydWRzJyk7XG4gIH1cblxuICB0aGlzLmdldEJ5SWQgPSBpZCA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL2NydWRzLyR7aWR9YCk7XG4gIH1cblxuICB0aGlzLmFkZENydWQ9IChjcnVkKSA9PntcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS9jcnVkc2AsIGNydWQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcblxuICB0aGlzLmRlbGV0ZUNydWQgPSAoaWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5kZWxldGUoYC9hcGkvY3J1ZHMvJHtpZH1gKVxuICAgICAgLnRoZW4oICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG4gIHRoaXMudXBkYXRlQ3J1ZCA9IChpZCwgY3J1ZCkgPT57XG4gICAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL2NydWRzLyR7aWR9YCwgY3J1ZClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKGNydWQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG5cbn0pO1xuXG4vL2luIHJlc2lkZW50cyBSZXNpZGVudC5nZXRBbGwoKVxuLy8gICAgICAgICAgICAgICAgLnRoZW4ocmVzaWRlbnRzID0+e30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdVc2VyJywgZnVuY3Rpb24oJGh0dHAsICRxKSB7XG5cbiAgdGhpcy5wcm9maWxlID0gKCkgPT4ge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvcHJvZmlsZScpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KTtcbiAgfTtcblxuICB0aGlzLmdldFByb2ZpbGUgPSAoaWQpID0+e1xuICAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuZ2V0QWxsID0gKCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpO1xuICB9XG5cbiAgdGhpcy51cGRhdGVQcm9maWxlID0gKGlkLCBwcm9maWxlT2JqKSA9PntcbiAgICBjb25zb2xlLmxvZyhcImhlcmVcIik7XG4gICAgY29uc29sZS5sb2coaWQgLCBcIiBcIiAscHJvZmlsZU9iaik7XG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YCwgIHByb2ZpbGVPYmopXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuZGVsZXRlQWNjb3VudCA9IChpZCkgPT57XG4gICAgcmV0dXJuICRodHRwLmRlbGV0ZShgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YClcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG5cbiAgdGhpcy5hZGRGYXZvcml0ZVRvVXNlciA9IChpZCwgeWVscElkKSA9PntcbiAgICAvL2NvbnNvbGUubG9nKFwiYWRkRmF2b3JpdGVUb1VzZXJcIiwgXCJpZDpcIiwgaWQsIFwieWVscElkXCIsIHllbHBJZClcbiAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH0vYWRkLyR7eWVscElkfWApXG4gICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJyZXMgbG4gNTM6XCIsIHJlcyk7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLnJlbW92ZUZhdm9yaXRlZnJvbVVzZXIgPSAoaWQsIHllbHBJZCkgPT57XG4gICAgY29uc29sZS5sb2coXCJyZW1vdmUgRmF2b3JpdGVcIiwgXCJpZDpcIiwgaWQsIFwieWVscElkXCIsIHllbHBJZClcbiAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH0vcmVtb3ZlLyR7eWVscElkfWApXG4gICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzIGxuIDUzOlwiLCByZXMpO1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG4gXG5cbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdXYWxsUG9zdCcsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuXG4gICAgdGhpcy5hZGRXYWxsUG9zdD0gKHdhbGxwb3N0KSA9PntcbiAgICBjb25zb2xlLmxvZyhcImluIGFkZCB3YWxscG9zdDogXCIsIHdhbGxwb3N0KTtcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS93YWxscG9zdHNgLCB3YWxscG9zdClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG5cbiAgICB0aGlzLmdldFdhbGxQb3N0cyA9ICh1c2VySWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5nZXQoYC9hcGkvd2FsbHBvc3RzLyR7dXNlcklkfWApXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVycj0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjogXCIsIGVycik7XG4gICAgICB9KTtcbiAgfTtcblxufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
